
void circleflatflux_through_all(int run){

  //TRestRun * t = new TRestRun("simFiles/Run_g4Analysis_00007_Isotopes_Ar_Fe55.root");
  TFile * fin = new TFile (Form("simFiles/Run_g4Analysis_000%d_Isotopes_Ar_flatflux.root", run), "read");
  
  //t->GetAnalysisTree()->Draw("hitsAnaAfterSmear_energy>>histo");
  TTree * t = (TTree*)fin ->Get("AnalysisTree;2");
 
  TCanvas * c1 = new TCanvas("c1","areas",1700,1100);
  TH1F * h = new TH1F("histo","histograma", 300, 0, 40);
  TH1F * h2 = new TH1F("histo2","histograma2", 300, 0, 40);
  
  t->Draw("hitsAnaBefore_energy>>histo", "", "goff"); 
 
  
  h->SetTitle(""); 
  h->GetXaxis()->SetTitle("energy (keV)");  
  h->GetXaxis()->SetTitleSize(0.045); 
  h->GetXaxis()->CenterTitle(); 
  h->GetXaxis()->SetTitleOffset(0.9);  
  h->GetXaxis()->SetLabelSize(0.04); 
  h->GetYaxis()->SetTitle("counts/bin"); 
  h->GetYaxis()->SetTitleSize(0.045); 
  h->GetYaxis()->CenterTitle(); 
  h->GetYaxis()->SetTitleOffset(1.2); 
  h->GetYaxis()->SetLabelSize(0.04); 
  h->GetYaxis()->SetRangeUser(0,1800);
  h->SetLineColor(kMagenta+2);
  h->SetFillColorAlpha(kMagenta+1, 0.75);
  h->SetFillStyle(3001); 
  h->SetStats(0);
  h->Draw();   

  t->Draw("hitsReadoutAnalysis_readoutEnergy>>histo2", "", "SAME");  
  h2->SetLineColor(kBlue+1);
  h2->SetFillColorAlpha(kBlue, 0.35);
  h2->SetFillStyle(3001); 
  h2->Draw("same");   

  
  TLegend *legend = new TLegend(0.48 ,0.7,0.9,0.8);
  legend->SetBorderSize(0);
  legend->SetTextSize(0.03); 
	legend->AddEntry(h,"deposited energy before smearing","l");
	legend->AddEntry(h2,"readout energy after complete analysis", "l");
  legend->SetFillColor(kWhite); 
	legend->Draw();
 
  c1->SaveAs(Form("plots/run_%d.png", run));   
}


void circleflatflux_through_window(int run){

  //TRestRun * t = new TRestRun("simFiles/Run_g4Analysis_00007_Isotopes_Ar_Fe55.root");
  TFile * fin = new TFile (Form("simFiles/Run_g4Analysis_000%d_Isotopes_Ar_flatflux.root", run), "read");
  
  //t->GetAnalysisTree()->Draw("hitsAnaAfterSmear_energy>>histo");
  TTree * t = (TTree*)fin ->Get("AnalysisTree;2");
 
  TCanvas * c1 = new TCanvas("c1","areas",1700,1100);
  TH1F * h = new TH1F("histo","histograma", 300, 0, 20);
  TH1F * h2 = new TH1F("histo2","histograma2", 300, 0, 20);
  
  t->Draw("hitsAnaBefore_energy>>histo", "", "goff"); 
 
  
  h->SetTitle(""); 
  h->GetXaxis()->SetTitle("energy (keV)");  
  h->GetXaxis()->SetTitleSize(0.045); 
  h->GetXaxis()->CenterTitle(); 
  h->GetXaxis()->SetTitleOffset(0.9);  
  h->GetXaxis()->SetLabelSize(0.04); 
  h->GetYaxis()->SetTitle("counts/bin"); 
  h->GetYaxis()->SetTitleSize(0.045); 
  h->GetYaxis()->CenterTitle(); 
  h->GetYaxis()->SetTitleOffset(1.2); 
  h->GetYaxis()->SetLabelSize(0.04); 
  h->GetXaxis()->SetRangeUser(0,30);
  h->SetLineColor(kMagenta+2);
  h->SetFillColorAlpha(kMagenta+3, 1.0);
  h->SetFillStyle(3001); 
  h->SetStats(0);
  h->Draw();   

  t->Draw("hitsReadoutAnalysis_readoutEnergy>>histo2", "", "SAME");  
  h2->SetLineColor(kBlue+1);
  h2->SetFillColorAlpha(kBlue, 0.35);
  h2->SetFillStyle(3001); 
  h2->Draw("same");   

  
  TLegend *legend = new TLegend(0.5 ,0.7,0.85,0.8);
  legend->SetBorderSize(0);
  legend->SetTextSize(0.03); 
	legend->AddEntry(h,"deposited energy before smearing","l");
	legend->AddEntry(h2,"readout energy after complete analysis", "l");
  legend->SetFillColor(kWhite); 
	legend->Draw();
 
  c1->SaveAs(Form("plots/run_%d.png", run));   
}


void monochromatic(int run){

  //TRestRun * t = new TRestRun("simFiles/Run_g4Analysis_00007_Isotopes_Ar_Fe55.root");
  TFile * fin = new TFile (Form("simFiles/Run_g4Analysis_000%d_Isotopes_Ar_flatflux.root", run), "read");
  
  //t->GetAnalysisTree()->Draw("hitsAnaAfterSmear_energy>>histo");
  TTree * t = (TTree*)fin ->Get("AnalysisTree;2");
 
  TCanvas * c1 = new TCanvas("c1","areas",1700,1100);
  TH1F * h = new TH1F("histo","histograma", 300, 0, 12);
  TH1F * h2 = new TH1F("histo2","histograma2", 300, 0, 12);
  
  t->Draw("hitsAnaBefore_energy>>histo", "", "goff"); 
 
  
  h->SetTitle(""); 
  h->GetXaxis()->SetTitle("energy (keV)");  
  h->GetXaxis()->SetTitleSize(0.045); 
  h->GetXaxis()->CenterTitle(); 
  h->GetXaxis()->SetTitleOffset(0.9);  
  h->GetXaxis()->SetLabelSize(0.04); 
  h->GetYaxis()->SetTitle("counts/bin"); 
  h->GetYaxis()->SetTitleSize(0.045); 
  h->GetYaxis()->CenterTitle(); 
  h->GetYaxis()->SetTitleOffset(1.2); 
  h->GetYaxis()->SetLabelSize(0.04); 
  h->GetXaxis()->SetRangeUser(0,30);
  h->SetLineColor(kMagenta+2);
  h->SetFillColorAlpha(kMagenta+1, 0.75);
  h->SetFillStyle(3001); 
  h->SetStats(0);
  h->Draw();   

  t->Draw("hitsReadoutAnalysis_readoutEnergy>>histo2", "", "SAME");  
  h2->SetLineColor(kBlue+1);
  h2->SetFillColorAlpha(kBlue, 0.35);
  h2->SetFillStyle(3001); 
  h2->Draw("same");   

  
  TLegend *legend = new TLegend(0.5 ,0.7,0.85,0.8);
  legend->SetBorderSize(0);
  legend->SetTextSize(0.03); 
	legend->AddEntry(h,"deposited energy before smearing","l");
	legend->AddEntry(h2,"readout energy after complete analysis", "l");
  legend->SetFillColor(kWhite); 
	legend->Draw();
 
  c1->SaveAs(Form("plots/run_%d.png", run));   
}



void circle_efficiency_plot(){

  TCanvas * c1 = new TCanvas("c1", "c1", 2200, 1600); 

  const int npoints=63;
  double energies[npoints] = {0.0, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0, 2.25, 2.5, 2.75, 3.0, 3.25, 3.5, 3.75, 4.0, 4.25, 4.5, 4.75, 5.0, 5.25, 5.5, 5.75, 6.0, 6.25, 6.5, 6.75, 7.0, 7.25, 7.5, 7.75, 8.0, 8.25, 8.5, 8.75, 9.0, 9.25, 9.5, 9.75, 10.0, 10.25, 10.5, 10.75, 11.0, 11.25, 11.5, 11.75, 12.0, 12.25, 12.5, 12.75, 13.0, 13.25, 13.5, 13.75, 14.0, 14.25, 14.5, 14.75, 15.0, 15.25, 15.5, 15.75, 16.0};

  double eff_P12[npoints] = {0.0, 0.009518754, 0.655231423, 3.701128225, 8.492149362, 12.40882327, 15.71734475, 17.46196465, 17.6817639, 16.94154203, 15.41863942, 23.93705206, 24.63156239, 25.25260626, 25.30791475, 25.51400356, 24.91046034, 25.18297714, 24.75118205, 24.05377351, 23.25284961, 22.25280542, 21.3334238, 20.25757867, 19.36657131, 18.61427502, 17.78481962, 16.50578478, 15.74175916, 14.73961417, 13.98428964, 12.95269033, 12.16998029, 11.64371794, 10.7319532, 10.10309966, 9.621916529, 9.099528935, 8.473204877, 8.008222729, 7.589479323, 7.094726914, 6.754466032, 6.32593757, 5.937564182, 5.72499934, 5.362996932, 5.042797229, 4.80110972, 4.676251085, 4.357632437, 4.065199071, 3.904057632, 3.724909097, 3.591149403, 3.384323258, 3.193539759, 3.081948533, 2.938361927, 2.807541313, 2.662579315, 2.59757085, 2.47063726};

  double eff_P2[npoints] = {0.0, 0.009524987, 0.656977823, 3.734598435, 8.528810194, 12.73848377, 16.28807773, 19.08007141, 20.78644635, 20.31627184, 20.03908296, 24.3148658, 24.96123624, 25.87905119, 25.81098996, 26.05053482, 26.35081255, 26.52800533, 26.7252857, 26.48901099, 26.54501351, 26.08142838, 25.73637604, 24.71522974, 24.41574883, 23.83175262, 22.95288606, 22.09875129, 21.19398404, 20.5686011, 19.34334487, 18.41874476, 17.55789167, 16.79885399, 15.97230451, 15.19298586, 14.42901829, 13.77749602, 13.159302, 12.19933537, 11.69783134, 10.8562763, 10.44668835, 9.775066062, 9.536297906, 9.026712615, 8.627962267, 8.254671635, 7.659834759, 7.443940181, 6.949301385, 6.811309867, 6.348347829, 6.106362108, 5.781426085, 5.59269578, 5.28476456, 5.123813686, 4.867440287, 4.63878327, 4.437602262, 4.272506866, 4.081257291};

  TGraph* graphP12 = new TGraph(npoints, energies, eff_P12);
  TGraph* graphP2 = new TGraph(npoints, energies, eff_P2);
  
  graphP12->SetMarkerStyle(20);
  graphP12->SetMarkerSize(1.3);
  graphP12->SetMarkerColor(kMagenta+2); 
  graphP12->SetLineColor(kMagenta+1); 
  graphP12->SetLineWidth(1);

  graphP2->SetMarkerStyle(20);
  graphP2->SetMarkerSize(1.3);
  graphP2->SetMarkerColor(kAzure); 
  graphP2->SetLineColor(kAzure+7); 
  graphP2->SetLineWidth(1);  
  
  graphP12->Draw("APL");
  graphP2->Draw("PLsame");
    
  graphP12->SetTitle("");  
  graphP12->GetXaxis()->SetTitle("Energy (keV)");         
  graphP12->GetXaxis()->SetTitleSize(0.043); 
  //graphP12->GetXaxis()->CenterTitle(); 
  graphP12->GetXaxis()->SetTitleOffset(1.1);  
  graphP12->GetXaxis()->SetLabelSize(0.045); 
  graphP12->GetYaxis()->SetTitle("Efficiency (%)");  
  graphP12->GetYaxis()->SetTitleSize(0.043);  
  //graphP12->GetYaxis()->CenterTitle(); 
  graphP12->GetYaxis()->SetTitleOffset(1.0); 
  graphP12->GetYaxis()->SetLabelSize(0.04); 
  graphP12->GetYaxis()->SetRangeUser(0,110);
  
  
  TLegend *legend = new TLegend(0.8,0.75,0.95,0.85);  
  legend->SetTextSize(0.03); 
  legend->AddEntry(graphP12,"P = 1.2 bar","p"); 
  legend->AddEntry(graphP2, "P = 2.0 bar", "p");
  legend->SetFillColor(kWhite); 
  legend->Draw(); 
    
//  TF1* fitFunc = new TF1("fitFunc", "pol5"); 
//  graphP12->Fit(fitFunc, "same"); 
//  fitFunc->Draw("same");

  c1->SaveAs("efficiency_circle.png");  

}


void efficiency_plot(){ 

  TCanvas * c1 = new TCanvas("c1", "c1", 3000, 1500); 
  c1 ->Divide(2,1);
gStyle->SetTextFont(42);
  
  const int npoints=65;
  double energies[npoints] = {0.0, 0.25, 0.50, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0, 2.25, 2.5, 2.75, 3.0, 3.25, 3.5, 3.75, 4.0, 4.25, 4.5, 4.75, 5.0, 5.25, 5.5, 5.75, 6.0, 6.25, 6.5, 6.75, 7.0, 7.25, 7.5, 7.75, 8.0, 8.25, 8.5, 8.75, 9.0, 9.25, 9.5, 9.75, 10.0, 10.25, 10.5, 10.75, 11.0, 11.25, 11.5, 11.75, 12.0, 12.25, 12.5, 12.75, 13.0, 13.25, 13.5, 13.75, 14.0, 14.25, 14.5, 14.75, 15.0, 15.25, 15.5, 15.75, 16.0};

  double eff_P12[npoints] = {0.0, 4.503170479, 0.527532757, 3.097749901, 19.56004171, 41.19834711, 57.89595913, 67.3463839, 74.27267968, 73.72219329, 70.71972663, 64.31303897, 58.01477486, 87.91043372, 89.20303605, 90.04585403, 91.02158273, 90.3750952, 89.69685523, 87.43088832, 85.07019438, 83.71048692, 80.38487508, 77.47395833, 74.18023211, 69.90262614, 66.57090807, 63.20660497, 59.38831787, 56.7674349, 52.5440694, 50.13252757, 47.49912382, 44.21096967, 41.52080218, 39.14643729, 36.37010676, 34.53561426, 32.19676789, 30.84477368, 28.00598392, 26.88488194, 25.70105554, 24.19350448, 22.99709423, 21.48402948, 20.48501068, 19.39766331, 18.18028502, 17.17038722, 16.38648197, 15.63166017, 14.9892896, 13.9834574, 13.35714172, 12.52487187, 11.95756292, 11.33586469, 11.23569763, 10.51281721, 10.071068, 9.633601852, 9.166380789, 8.545489583, 8.279174908};

  double eff_P16[npoints] = {0.0, 4.481630474, 0.531249023, 3.11519737, 19.5519188, 41.12570202, 58.59209598, 68.78472222, 75.41606505, 78.61964896, 77.38290079, 73.1378472, 67.49183896, 88.71939736, 89.94195452, 91.59599075, 91.70524691, 92.54339184, 92.44152329, 91.43323101, 90.79795299, 89.63363475, 86.89980069, 85.05502307, 82.18966847, 79.73443983, 76.80903919, 73.73109115, 70.47745163, 67.28734659, 63.97748593, 60.56087812, 58.0341984, 54.03435416, 51.76374966, 48.97959184, 46.10258182, 43.40854, 41.301059, 38.80716207, 36.33665717, 34.47533429, 33.04474354, 31.47781368, 29.57051177, 27.82749192, 26.44229346, 25.12911193, 23.74175913, 22.64247642, 21.52384209, 20.46997145, 19.2844523, 18.43158854, 17.58391722, 16.76363778, 16.03996401, 15.15448138, 14.36860302, 14.03989569, 13.27387365, 12.67704625, 12.00757521, 11.53711264, 11.12816991};

  double eff_P2[npoints] = {0.0, 4.486343549, 0.528649917, 3.11730489, 19.53250835, 41.21344969, 57.42500144, 68.5607373, 76.48600725, 80.46051565, 81.07049608, 79.84906872, 74.34456929, 89.25401322, 91.15763311, 91.5475391, 92.68623462, 93.23023052, 93.24902724, 93.0273097, 92.97940238, 92.83720035, 91.54342055, 89.92255295, 85.59502664, 85.63943162, 83.19799585, 80.8377226, 77.70808203, 74.79409479, 71.88761022, 68.71568138, 66.15998349, 62.85957113, 59.83983114, 57.15640372, 54.21631531, 51.31118881, 48.85559717, 46.15840118, 43.60313316, 41.52892562, 39.2594169, 37.6159102, 35.76505507, 34.087858, 31.68972159, 30.320075, 28.75231822, 27.96751482, 26.23213765, 25.24840262, 23.9957831, 22.77636022, 21.88841202, 20.83589719, 19.62332928, 18.8472312, 17.98213654, 17.22365553, 16.32894486, 15.68179742, 15.02237412, 14.23021946, 13.69651951};
  
  double eff_P3[npoints] = {0.0, 4.499523356, 0.528518774, 3.125088531, 19.59775214, 40.85350841, 58.26951184, 68.94150418, 77.27237324, 82.40955858, 85.52371116, 86.56508489, 83.51510067, 89.62851216, 90.74814392, 91.95236723, 93.15982972, 94.15780747, 93.72927638, 95.0377562, 94.38950357, 95.42907697, 94.69978486, 94.88630819, 94.12277304, 93.07015867, 92.14184397, 90.83356669, 89.25096383, 87.03239664, 84.91026311, 82.58179352, 79.7704918, 76.91882502, 74.59330878, 71.28857686, 68.23005093, 66.00397614, 62.852078, 61.02753697, 58.37361562, 55.71337098, 52.64622405, 50.66816335, 49.00237775, 46.24913971, 43.72566496, 42.61205916, 40.82230087, 38.67825942, 37.02611122, 35.47817407, 33.99400954, 32.7702219, 30.76018282, 29.22922923, 28.27627289, 27.16611396, 26.41669843, 24.81577927, 23.69562325, 23.16450115, 22.12431353, 21.07365318, 20.11922504};

  
  double eff_P12L2[npoints] = {0.0, 4.505114491, 0.527807219, 3.095495136, 19.57647986, 41.14563988, 57.89106956, 68.5131397, 77.2766156, 82.35879572, 84.25784563, 83.19805874, 79.60916226, 88.74222138, 89.73969219, 91.58482573, 92.48689575, 93.17054188, 93.77751688, 93.65825015, 93.80496385, 93.75792451, 93.24992726, 92.6552586, 91.38029239, 89.23148148, 87.40243238, 84.95816821, 83.17676463, 81.52403481, 78.13032541, 74.94000155, 72.47651259, 69.77652419, 66.20153973, 63.11555817, 60.15842839, 57.21627668, 54.51016743, 52.53386854, 50.70741981, 46.39006211, 45.40927332, 43.15852923, 40.85746985, 39.03979785, 37.05981669, 35.05398497, 34.14051714, 31.76359371, 30.79106545, 29.16103277, 28.18548387, 26.80173489, 25.62115797, 24.4720531, 22.86692936, 21.89851485, 21.32185853, 20.26073161, 19.2427146, 18.78754076, 17.94776887, 16.98250015, 16.39557457};
  
  double eff_P16L2[npoints] = {0.0, 4.481022165, 0.531618141, 3.108057347, 19.56889764, 41.20883667, 58.69462771, 68.83821178, 76.84389753, 82.53227822, 86.00951146, 86.46603462, 85.87341335, 89.3217621, 90.51781473, 91.63857047, 92.56534366, 93.4553954, 94.07334963, 94.22265817, 94.53347753, 95.20999311, 94.74767271, 94.5890411, 94.35028249, 93.40733591, 92.84622732, 91.7558988, 90.30612245, 87.95464853, 86.30904724, 84.22559653, 81.68433451, 79.51383205, 77.4152576, 74.01448723, 71.67535369, 68.33581931, 66.47058824, 63.04376483, 60.77895673, 58.41704718, 55.81818182, 53.05035326, 51.33293679, 48.59611231, 46.63719452, 44.45815731, 42.72403398, 40.52210929, 39.26188666, 37.10248772, 35.88235294, 34.29527705, 32.27746311, 30.67910171, 29.34433599, 28.51531815, 27.56840948, 26.41498425, 25.33935383, 24.37272084, 23.33593954, 22.23936686, 21.63865546};
  
  double eff_P2L2[npoints] = {0.0, 4.486567015, 0.529380283, 3.115396809, 19.47889117, 41.22440538, 57.48458124, 68.55162855, 76.90697674, 82.94761467, 86.66666667, 88.38841507, 88.83629544, 89.4513174, 91.00276691, 91.86827957, 92.86959891, 93.85214008, 93.66718628, 94.52014508, 95.00147304, 95.46440544, 96.08888889, 95.53342536, 95.87517228, 95.93080401, 95.41678882, 94.1937977, 93.64228265, 92.50592136, 90.92350746, 89.89073547, 87.71882575, 85.64044156, 83.77684607, 81.51456959, 78.88924976, 76.41605782, 73.78774016, 71.31377175, 68.06094378, 66.71986677, 63.40414268, 61.33981079, 58.69899686, 56.3093063, 54.29272748, 51.73631868, 50.05023, 47.80983176, 46.219763, 43.74183921, 42.36727668, 40.86634741, 39.87056119, 37.90506432, 36.11261715, 34.62591412, 33.27812185, 31.64408591, 30.72024008, 29.73763776, 28.3161512, 27.03765491, 26.61243123};

  double eff_P3L2[npoints] = {0.0, 4.494193507, 0.528746747, 3.11395351, 19.56945621, 40.89452932, 58.32650673, 68.91101518, 77.25148021, 82.86214661, 87.03265914, 90.15412511, 91.14607153, 89.45783133, 91.16722249, 91.77372963, 93.33462507, 94.03057747, 93.79269959, 95.22733968, 95.01080338, 95.982231, 95.8678501, 96.32556302, 96.58314351, 96.69339669, 96.82209682, 96.88519727, 96.48741983, 96.61417323, 95.95692609, 95.30885781, 94.92081885, 93.8305797, 92.93139293, 91.086454, 90.43846721, 88.44592766, 86.40571277, 84.51457148, 82.64755481, 80.26802598, 78.36970475, 76.22925149, 73.84802247, 71.11176169, 69.59657265, 66.8228162, 65.2984067, 63.52925689, 60.9407468, 58.83253706, 56.11510791, 55.22937892, 53.17504448, 51.59166936, 48.58221134, 47.03727538, 46.02014138, 44.07662265, 43.17146501, 40.97019796, 39.88709198, 37.81208539, 36.93515924} ;
  
//  double mylar[npoints] = {0.00, 5.69, 0.68, 2.74, 19.33, 40.07, 58.12, 68.47, 77.27, 82.94, 87.17, 90.00, 92.20, 93.72, 94.95, 95.89, 96.61, 97.15, 97.61, 97.97, 98.25, 98.50, 98.69, 98.86, 99.00, 99.11, 99.21, 99.30, 99.37, 99.44, 99.49, 99.54, 99.58, 99.62, 99.65, 99.68, 99.71, 99.73, 99.75, 99.77, 99.79, 99.80, 99.82, 99.83, 99.84, 99.85, 99.86, 99.87, 99.88, 99.89, 99.89, 99.90, 99.91, 99.91, 99.91, 99.92, 99.92, 99.93, 99.93, 99.93, 99.94, 99.94, 99.94, 99.94, 99.95} ;
   
   double mylar_x[] = {0.01, 0.02599, 0.04198, 0.05797, 0.07396, 0.08995, 0.10594, 0.12193, 0.13792, 0.15391, 0.1699, 0.18589, 0.20188, 0.21787, 0.23386, 0.24985, 0.26584, 0.28183, 0.29782, 0.31381, 0.3298, 0.34579, 0.36178, 0.37777, 0.39376, 0.40975, 0.42574, 0.44173, 0.45772, 0.47371, 0.4897, 0.50569, 0.52168, 0.53767, 0.55366, 0.56965, 0.58564, 0.60163, 0.61762, 0.63361, 0.6496, 0.66559, 0.68158, 0.69757, 0.71356, 0.72955, 0.74554, 0.76153, 0.77752, 0.79351, 0.8095, 0.82549, 0.84148, 0.85747, 0.87346, 0.88945, 0.90544, 0.92143, 0.93742, 0.95341, 0.9694, 0.98539, 1.0014, 1.0174, 1.0334, 1.0493, 1.0653, 1.0813, 1.0973, 1.1133, 1.1293, 1.1453, 1.1613, 1.1773, 1.1933, 1.2092, 1.2252, 1.2412, 1.2572, 1.2732, 1.2892, 1.3052, 1.3212, 1.3372, 1.3532, 1.3692, 1.3851, 1.4011, 1.4171, 1.4331, 1.4491, 1.4651, 1.4811, 1.4971, 1.5131, 1.529, 1.545, 1.561, 1.577, 1.593, 1.609, 1.625, 1.641, 1.657, 1.673, 1.6889, 1.7049, 1.7209, 1.7369, 1.7529, 1.7689, 1.7849, 1.8009, 1.8169, 1.8329, 1.8488, 1.8648, 1.8808, 1.8968, 1.9128, 1.9288, 1.9448, 1.9608, 1.9768, 1.9928, 2.0088, 2.0247, 2.0407, 2.0567, 2.0727, 2.0887, 2.1047, 2.1207, 2.1367, 2.1527, 2.1686, 2.1846, 2.2006, 2.2166, 2.2326, 2.2486, 2.2646, 2.2806, 2.2966, 2.3126, 2.3286, 2.3445, 2.3605, 2.3765, 2.3925, 2.4085, 2.4245, 2.4405, 2.4565, 2.4725, 2.4884, 2.5044, 2.5204, 2.5364, 2.5524, 2.5684, 2.5844, 2.6004, 2.6164, 2.6324, 2.6483, 2.6643, 2.6803, 2.6963, 2.7123, 2.7283, 2.7443, 2.7603, 2.7763, 2.7923, 2.8083, 2.8242, 2.8402, 2.8562, 2.8722, 2.8882, 2.9042, 2.9202, 2.9362, 2.9522, 2.9681, 2.9841, 3.0001, 3.0161, 3.0321, 3.0481, 3.0641, 3.0801, 3.0961, 3.1121, 3.1281, 3.144, 3.16, 3.176, 3.192, 3.208, 3.224, 3.24, 3.256, 3.272, 3.2879, 3.3039, 3.3199, 3.3359, 3.3519, 3.3679, 3.3839, 3.3999, 3.4159, 3.4319, 3.4478, 3.4638, 3.4798, 3.4958, 3.5118, 3.5278, 3.5438, 3.5598, 3.5758, 3.5918, 3.6077, 3.6237, 3.6397, 3.6557, 3.6717, 3.6877, 3.7037, 3.7197, 3.7357, 3.7517, 3.7676, 3.7836, 3.7996, 3.8156, 3.8316, 3.8476, 3.8636, 3.8796, 3.8956, 3.9116, 3.9276, 3.9435, 3.9595, 3.9755, 3.9915, 4.0075, 4.0235, 4.0395, 4.0555, 4.0715, 4.0874, 4.1034, 4.1194, 4.1354, 4.1514, 4.1674, 4.1834, 4.1994, 4.2154, 4.2314, 4.2474, 4.2633, 4.2793, 4.2953, 4.3113, 4.3273, 4.3433, 4.3593, 4.3753, 4.3913, 4.4073, 4.4232, 4.4392, 4.4552, 4.4712, 4.4872, 4.5032, 4.5192, 4.5352, 4.5512, 4.5671, 4.5831, 4.5991, 4.6151, 4.6311, 4.6471, 4.6631, 4.6791, 4.6951, 4.7111, 4.727, 4.743, 4.759, 4.775, 4.791, 4.807, 4.823, 4.839, 4.855, 4.871, 4.8869, 4.9029, 4.9189, 4.9349, 4.9509, 4.9669, 4.9829, 4.9989, 5.0149, 5.0309, 5.0469, 5.0628, 5.0788, 5.0948, 5.1108, 5.1268, 5.1428, 5.1588, 5.1748, 5.1908, 5.2068, 5.2227, 5.2387, 5.2547, 5.2707, 5.2867, 5.3027, 5.3187, 5.3347, 5.3507, 5.3666, 5.3826, 5.3986, 5.4146, 5.4306, 5.4466, 5.4626, 5.4786, 5.4946, 5.5106, 5.5265, 5.5425, 5.5585, 5.5745, 5.5905, 5.6065, 5.6225, 5.6385, 5.6545, 5.6705, 5.6864, 5.7024, 5.7184, 5.7344, 5.7504, 5.7664, 5.7824, 5.7984, 5.8144, 5.8304, 5.8464, 5.8623, 5.8783, 5.8943, 5.9103, 5.9263, 5.9423, 5.9583, 5.9743, 5.9903, 6.0062, 6.0222, 6.0382, 6.0542, 6.0702, 6.0862, 6.1022, 6.1182, 6.1342, 6.1502, 6.1661, 6.1821, 6.1981, 6.2141, 6.2301, 6.2461, 6.2621, 6.2781, 6.2941, 6.3101, 6.326, 6.342, 6.358, 6.374, 6.39, 6.406, 6.422, 6.438, 6.454, 6.47, 6.4859, 6.5019, 6.5179, 6.5339, 6.5499, 6.5659, 6.5819, 6.5979, 6.6139, 6.6299, 6.6459, 6.6618, 6.6778, 6.6938, 6.7098, 6.7258, 6.7418, 6.7578, 6.7738, 6.7898, 6.8057, 6.8217, 6.8377, 6.8537, 6.8697, 6.8857, 6.9017, 6.9177, 6.9337, 6.9497, 6.9656, 6.9816, 6.9976, 7.0136, 7.0296, 7.0456, 7.0616, 7.0776, 7.0936, 7.1096, 7.1255, 7.1415, 7.1575, 7.1735, 7.1895, 7.2055, 7.2215, 7.2375, 7.2535, 7.2695, 7.2854, 7.3014, 7.3174, 7.3334, 7.3494, 7.3654, 7.3814, 7.3974, 7.4134, 7.4294, 7.4454, 7.4613, 7.4773, 7.4933, 7.5093, 7.5253, 7.5413, 7.5573, 7.5733, 7.5893, 7.6052, 7.6212, 7.6372, 7.6532, 7.6692, 7.6852, 7.7012, 7.7172, 7.7332, 7.7492, 7.7651, 7.7811, 7.7971, 7.8131, 7.8291, 7.8451, 7.8611, 7.8771, 7.8931, 7.9091, 7.925, 7.941, 7.957, 7.973, 7.989, 8.005, 8.021, 8.037, 8.053, 8.069, 8.0849, 8.1009, 8.1169, 8.1329, 8.1489, 8.1649, 8.1809, 8.1969, 8.2129, 8.2289, 8.2448, 8.2608, 8.2768, 8.2928, 8.3088, 8.3248, 8.3408, 8.3568, 8.3728, 8.3888, 8.4047, 8.4207, 8.4367, 8.4527, 8.4687, 8.4847, 8.5007, 8.5167, 8.5327, 8.5487, 8.5646, 8.5806, 8.5966, 8.6126, 8.6286, 8.6446, 8.6606, 8.6766, 8.6926, 8.7086, 8.7245, 8.7405, 8.7565, 8.7725, 8.7885, 8.8045, 8.8205, 8.8365, 8.8525, 8.8685, 8.8845, 8.9004, 8.9164, 8.9324, 8.9484, 8.9644, 8.9804, 8.9964, 9.0124, 9.0284, 9.0443, 9.0603, 9.0763, 9.0923, 9.1083, 9.1243, 9.1403, 9.1563, 9.1723, 9.1883, 9.2043, 9.2202, 9.2362, 9.2522, 9.2682, 9.2842, 9.3002, 9.3162, 9.3322, 9.3482, 9.3641, 9.3801, 9.3961, 9.4121, 9.4281, 9.4441, 9.4601, 9.4761, 9.4921, 9.5081, 9.524, 9.54, 9.556, 9.572, 9.588, 9.604, 9.62, 9.636, 9.652, 9.668, 9.684, 9.6999, 9.7159, 9.7319, 9.7479, 9.7639, 9.7799, 9.7959, 9.8119, 9.8279, 9.8438, 9.8598, 9.8758, 9.8918, 9.9078, 9.9238, 9.9398, 9.9558, 9.9718, 9.9878, 10.004, 10.02, 10.036, 10.052, 10.068, 10.084, 10.1, 10.116, 10.132, 10.148, 10.164, 10.18, 10.196, 10.212, 10.228, 10.244, 10.26, 10.276, 10.292, 10.308, 10.324, 10.34, 10.356, 10.372, 10.388, 10.403, 10.419, 10.435, 10.451, 10.467, 10.483, 10.499, 10.515, 10.531, 10.547, 10.563, 10.579, 10.595, 10.611, 10.627, 10.643, 10.659, 10.675, 10.691, 10.707, 10.723, 10.739, 10.755, 10.771, 10.787, 10.803, 10.819, 10.835, 10.851, 10.867, 10.883, 10.899, 10.915, 10.931, 10.947, 10.963, 10.979, 10.995, 11.011, 11.027, 11.043, 11.059, 11.075, 11.091, 11.107, 11.123, 11.139, 11.155, 11.171, 11.187, 11.203, 11.219, 11.235, 11.251, 11.267, 11.283, 11.299, 11.315, 11.331, 11.347, 11.363, 11.379, 11.395, 11.411, 11.427, 11.443, 11.459, 11.475, 11.491, 11.507, 11.523, 11.539, 11.555, 11.571, 11.587, 11.603, 11.619, 11.635, 11.651, 11.667, 11.683, 11.699, 11.715, 11.731, 11.747, 11.763, 11.779, 11.795, 11.811, 11.827, 11.843, 11.859, 11.875, 11.891, 11.907, 11.923, 11.939, 11.955, 11.971, 11.987, 12.003, 12.018, 12.034, 12.05, 12.066, 12.082, 12.098, 12.114, 12.13, 12.146, 12.162, 12.178, 12.194, 12.21, 12.226, 12.242, 12.258, 12.274, 12.29, 12.306, 12.322, 12.338, 12.354, 12.37, 12.386, 12.402, 12.418, 12.434, 12.45, 12.466, 12.482, 12.498, 12.514, 12.53, 12.546, 12.562, 12.578, 12.594, 12.61, 12.626, 12.642, 12.658, 12.674, 12.69, 12.706, 12.722, 12.738, 12.754, 12.77, 12.786, 12.802, 12.818, 12.834, 12.85, 12.866, 12.882, 12.898, 12.914, 12.93, 12.946, 12.962, 12.978, 12.994, 13.01, 13.026, 13.042, 13.058, 13.074, 13.09, 13.106, 13.122, 13.138, 13.154, 13.17, 13.186, 13.202, 13.218, 13.234, 13.25, 13.266, 13.282, 13.298, 13.314, 13.33, 13.346, 13.362, 13.378, 13.394, 13.41, 13.426, 13.442, 13.458, 13.474, 13.49, 13.506, 13.522, 13.538, 13.554, 13.57, 13.586, 13.601, 13.617, 13.633, 13.649, 13.665, 13.681, 13.697, 13.713, 13.729, 13.745, 13.761, 13.777, 13.793, 13.809, 13.825, 13.841, 13.857, 13.873, 13.889, 13.905, 13.921, 13.937, 13.953, 13.969, 13.985, 14.001, 14.017, 14.033, 14.049, 14.065, 14.081, 14.097, 14.113, 14.129, 14.145, 14.161, 14.177, 14.193, 14.209, 14.225, 14.241, 14.257, 14.273, 14.289, 14.305, 14.321, 14.337, 14.353, 14.369, 14.385, 14.401, 14.417, 14.433, 14.449, 14.465, 14.481, 14.497, 14.513, 14.529, 14.545, 14.561, 14.577, 14.593, 14.609, 14.625, 14.641, 14.657, 14.673, 14.689, 14.705, 14.721, 14.737, 14.753, 14.769, 14.785, 14.801, 14.817, 14.833, 14.849, 14.865, 14.881, 14.897, 14.913, 14.929, 14.945, 14.961, 14.977, 14.993, 15.009, 15.025, 15.041, 15.057, 15.073, 15.089, 15.105, 15.121, 15.137, 15.153, 15.169, 15.185, 15.2, 15.216, 15.232, 15.248, 15.264, 15.28, 15.296, 15.312, 15.328, 15.344, 15.36, 15.376, 15.392, 15.408, 15.424, 15.44, 15.456, 15.472, 15.488, 15.504, 15.52, 15.536, 15.552, 15.568, 15.584, 15.6, 15.616, 15.632, 15.648, 15.664, 15.68, 15.696, 15.712, 15.728, 15.744, 15.76, 15.776, 15.792, 15.808, 15.824, 15.84, 15.856, 15.872, 15.888, 15.904, 15.92, 15.936, 15.952, 15.968, 15.984, 16.0};
   
   double mylar_y[] = {0, 0, 0, 3.08888e-27, 1.00362e-17, 1.17994e-12, 1.78144e-09, 2.39697e-07, 7.10199e-06, 7.74864e-05, 0.000443488, 0.00179068, 0.00643329, 0.0166467, 0.0336409, 0.0568937, 0.0882433, 0.126545, 2.43321e-08, 1.69009e-07, 8.73632e-07, 3.5554e-06, 1.18941e-05, 3.41071e-05, 9.22324e-05, 0.000220799, 0.000473102, 0.000923596, 0.00166648, 0.00281011, 0.00448212, 0.00683566, 0.0099715, 0.013993, 0.000516613, 0.000868137, 0.00138385, 0.00211241, 0.00310657, 0.00442876, 0.00617283, 0.00840884, 0.0110497, 0.0140338, 0.0176735, 0.0221818, 0.027362, 0.0332306, 0.0398304, 0.0472173, 0.0553414, 0.0641458, 0.0735806, 0.0835275, 0.0939261, 0.104778, 0.116086, 0.127799, 0.140183, 0.153004, 0.166199, 0.179652, 0.193302, 0.207087, 0.220917, 0.234944, 0.24917, 0.263391, 0.277609, 0.291783, 0.305879, 0.319864, 0.333732, 0.347474, 0.361042, 0.374452, 0.387667, 0.400737, 0.413645, 0.426387, 0.438991, 0.451358, 0.463496, 0.475386, 0.487037, 0.498449, 0.509615, 0.520532, 0.531217, 0.541658, 0.551856, 0.561829, 0.57159, 0.581154, 0.590551, 0.599721, 0.608679, 0.592527, 0.601266, 0.609811, 0.618143, 0.626278, 0.63421, 0.641959, 0.649508, 0.656882, 0.664064, 0.671079, 0.677971, 0.684703, 0.691277, 0.697708, 0.703986, 0.710104, 0.71607, 0.721893, 0.727569, 0.733103, 0.7385, 0.743761, 0.748893, 0.753897, 0.758783, 0.76354, 0.768187, 0.772685, 0.777072, 0.781414, 0.785646, 0.789784, 0.793829, 0.797781, 0.80163, 0.805387, 0.809068, 0.812656, 0.816169, 0.819588, 0.822932, 0.826202, 0.829394, 0.832513, 0.835565, 0.83855, 0.841461, 0.844304, 0.847091, 0.849802, 0.852466, 0.855072, 0.857612, 0.860104, 0.862529, 0.864907, 0.867237, 0.869519, 0.871744, 0.87392, 0.876049, 0.87814, 0.880183, 0.882187, 0.884142, 0.88606, 0.88793, 0.889771, 0.891563, 0.893327, 0.895052, 0.896748, 0.898395, 0.900014, 0.901613, 0.903164, 0.904686, 0.90618, 0.907634, 0.909069, 0.910484, 0.911861, 0.913208, 0.914536, 0.915845, 0.917114, 0.918365, 0.919586, 0.920787, 0.921969, 0.923122, 0.924265, 0.92537, 0.926464, 0.927539, 0.928594, 0.929611, 0.930637, 0.931624, 0.932611, 0.933569, 0.934497, 0.935425, 0.936334, 0.937223, 0.938103, 0.938963, 0.939803, 0.940624, 0.941444, 0.942245, 0.943036, 0.943808, 0.94457, 0.945302, 0.946044, 0.946767, 0.94747, 0.948163, 0.948856, 0.949529, 0.950193, 0.950837, 0.951471, 0.952105, 0.952719, 0.953333, 0.953928, 0.954513, 0.955098, 0.955663, 0.956228, 0.956784, 0.957309, 0.957855, 0.95838, 0.958896, 0.959403, 0.959908, 0.960395, 0.960881, 0.961357, 0.961824, 0.96229, 0.962747, 0.963184, 0.963631, 0.964068, 0.964495, 0.964912, 0.965329, 0.965736, 0.966134, 0.966541, 0.966929, 0.967316, 0.967694, 0.968061, 0.968429, 0.968797, 0.969145, 0.969503, 0.969851, 0.970189, 0.970527, 0.970855, 0.971183, 0.971501, 0.971819, 0.972128, 0.972436, 0.972744, 0.973043, 0.973341, 0.97363, 0.973908, 0.974197, 0.974475, 0.974744, 0.975023, 0.975291, 0.97555, 0.975809, 0.976068, 0.976316, 0.976575, 0.976814, 0.977053, 0.977292, 0.977531, 0.97776, 0.977989, 0.978218, 0.978447, 0.978656, 0.978875, 0.979094, 0.979303, 0.979513, 0.979722, 0.979921, 0.98012, 0.980319, 0.980519, 0.980708, 0.980897, 0.981086, 0.981266, 0.981455, 0.981634, 0.981814, 0.981993, 0.982162, 0.982342, 0.982511, 0.982681, 0.98284, 0.983, 0.983169, 0.983328, 0.983478, 0.983637, 0.983797, 0.983946, 0.984096, 0.984245, 0.984385, 0.984535, 0.984684, 0.984814, 0.984963, 0.985093, 0.985232, 0.985362, 0.985502, 0.985631, 0.985751, 0.98589, 0.98601, 0.98614, 0.986259, 0.986379, 0.986509, 0.986628, 0.986738, 0.986868, 0.986978, 0.987087, 0.987197, 0.987317, 0.987426, 0.987536, 0.987636, 0.987746, 0.987855, 0.987955, 0.988055, 0.988165, 0.988254, 0.988354, 0.988454, 0.988554, 0.988653, 0.988753, 0.988843, 0.988943, 0.989033, 0.989122, 0.989212, 0.989302, 0.989392, 0.989472, 0.989561, 0.989651, 0.989731, 0.989811, 0.989891, 0.989971, 0.99005, 0.99014, 0.99022, 0.9903, 0.99038, 0.99045, 0.990519, 0.990599, 0.990669, 0.990749, 0.990819, 0.990899, 0.990959, 0.991028, 0.991108, 0.991178, 0.991248, 0.991308, 0.991378, 0.991448, 0.991518, 0.991568, 0.991637, 0.991707, 0.991767, 0.991827, 0.991887, 0.991957, 0.992007, 0.992077, 0.992137, 0.992186, 0.992246, 0.992306, 0.992366, 0.992426, 0.992486, 0.992536, 0.992586, 0.992636, 0.992696, 0.992756, 0.992796, 0.992855, 0.992915, 0.992955, 0.993015, 0.993055, 0.993115, 0.993155, 0.993205, 0.993265, 0.993305, 0.993355, 0.993395, 0.993455, 0.993495, 0.993544, 0.993584, 0.993634, 0.993674, 0.993724, 0.993754, 0.993804, 0.993844, 0.993894, 0.993934, 0.993974, 0.994014, 0.994064, 0.994094, 0.994144, 0.994174, 0.994224, 0.994254, 0.994294, 0.994333, 0.994373, 0.994413, 0.994443, 0.994493, 0.994523, 0.994563, 0.994593, 0.994623, 0.994673, 0.994703, 0.994743, 0.994773, 0.994803, 0.994843, 0.994873, 0.994913, 0.994943, 0.994973, 0.995013, 0.995043, 0.995073, 0.995103, 0.995133, 0.995173, 0.995192, 0.995222, 0.995262, 0.995292, 0.995312, 0.995352, 0.995372, 0.995402, 0.995442, 0.995462, 0.995492, 0.995522, 0.995552, 0.995572, 0.995612, 0.995632, 0.995652, 0.995692, 0.995712, 0.995732, 0.995772, 0.995792, 0.995812, 0.995852, 0.995872, 0.995892, 0.995912, 0.995942, 0.995972, 0.995992, 0.996022, 0.996042, 0.996062, 0.996082, 0.996112, 0.996132, 0.996152, 0.996182, 0.996202, 0.996222, 0.996242, 0.996272, 0.996291, 0.996311, 0.996331, 0.996361, 0.996381, 0.996401, 0.996421, 0.996441, 0.996461, 0.996481, 0.996501, 0.996531, 0.996541, 0.996561, 0.996581, 0.996611, 0.996621, 0.996641, 0.996661, 0.996671, 0.996701, 0.996721, 0.996731, 0.996751, 0.996781, 0.996791, 0.996811, 0.996821, 0.996841, 0.996861, 0.996881, 0.996891, 0.996911, 0.996931, 0.996951, 0.996961, 0.996981, 0.996991, 0.997021, 0.997031, 0.997051, 0.997061, 0.997081, 0.997091, 0.997111, 0.997131, 0.997141, 0.997151, 0.997171, 0.997191, 0.997201, 0.997221, 0.997231, 0.997241, 0.997271, 0.997281, 0.997291, 0.997301, 0.997321, 0.997331, 0.997351, 0.997361, 0.997381, 0.997391, 0.997401, 0.997411, 0.997431, 0.997451, 0.997461, 0.997471, 0.997481, 0.997491, 0.997511, 0.997531, 0.997541, 0.997551, 0.997561, 0.997571, 0.997581, 0.997601, 0.997611, 0.997621, 0.997631, 0.997641, 0.997651, 0.997661, 0.997681, 0.997701, 0.997711, 0.997721, 0.997731, 0.997741, 0.997751, 0.997761, 0.997771, 0.997781, 0.997791, 0.997801, 0.997811, 0.997821, 0.997841, 0.997851, 0.997861, 0.997871, 0.99788, 0.99789, 0.9979, 0.99791, 0.99792, 0.99793, 0.99794, 0.99795, 0.99796, 0.99797, 0.99798, 0.99799, 0.998, 0.99801, 0.99802, 0.99803, 0.99804, 0.99804, 0.99805, 0.99806, 0.99807, 0.99809, 0.9981, 0.9981, 0.99811, 0.99812, 0.99813, 0.99813, 0.99814, 0.99815, 0.99817, 0.99817, 0.99818, 0.99819, 0.9982, 0.9982, 0.99821, 0.99822, 0.99822, 0.99823, 0.99825, 0.99826, 0.99826, 0.99827, 0.99828, 0.99828, 0.99829, 0.9983, 0.9983, 0.99831, 0.99833, 0.99833, 0.99834, 0.99835, 0.99835, 0.99836, 0.99837, 0.99837, 0.99838, 0.99838, 0.99839, 0.99841, 0.99841, 0.99842, 0.99843, 0.99843, 0.99844, 0.99844, 0.99845, 0.99846, 0.99846, 0.99847, 0.99847, 0.99849, 0.99849, 0.9985, 0.99851, 0.99851, 0.99852, 0.99852, 0.99853, 0.99853, 0.99854, 0.99854, 0.99855, 0.99856, 0.99857, 0.99858, 0.99858, 0.99859, 0.99859, 0.9986, 0.9986, 0.99861, 0.99861, 0.99862, 0.99862, 0.99863, 0.99863, 0.99865, 0.99865, 0.99866, 0.99866, 0.99867, 0.99867, 0.99868, 0.99868, 0.99868, 0.99869, 0.99869, 0.9987, 0.9987, 0.99871, 0.99872, 0.99873, 0.99873, 0.99874, 0.99874, 0.99875, 0.99875, 0.99875, 0.99876, 0.99876, 0.99877, 0.99877, 0.99878, 0.99878, 0.99878, 0.99879, 0.9988, 0.99881, 0.99881, 0.99881, 0.99882, 0.99882, 0.99883, 0.99883, 0.99883, 0.99884, 0.99884, 0.99885, 0.99885, 0.99885, 0.99886, 0.99886, 0.99887, 0.99888, 0.99888, 0.99889, 0.99889, 0.99889, 0.9989, 0.9989, 0.99891, 0.99891, 0.99891, 0.99892, 0.99892, 0.99892, 0.99893, 0.99893, 0.99893, 0.99894, 0.99894, 0.99894, 0.99896, 0.99896, 0.99896, 0.99897, 0.99897, 0.99897, 0.99898, 0.99898, 0.99898, 0.99899, 0.99899, 0.99899, 0.999, 0.999, 0.999, 0.99901, 0.99901, 0.99901, 0.99902, 0.99902, 0.99903, 0.99903, 0.99904, 0.99904, 0.99904, 0.99905, 0.99905, 0.99905, 0.99906, 0.99906, 0.99906, 0.99906, 0.99907, 0.99907, 0.99907, 0.99908, 0.99908, 0.99908, 0.99908, 0.99909, 0.99909, 0.99909, 0.9991, 0.99911, 0.99911, 0.99911, 0.99912, 0.99912, 0.99912, 0.99912, 0.99913, 0.99913, 0.99913, 0.99913, 0.99914, 0.99914, 0.99914, 0.99914, 0.99915, 0.99915, 0.99915, 0.99915, 0.99916, 0.99916, 0.99916, 0.99916, 0.99917, 0.99917, 0.99917, 0.99918, 0.99919, 0.99919, 0.99919, 0.99919, 0.9992, 0.9992, 0.9992, 0.9992, 0.99921, 0.99921, 0.99921, 0.99921, 0.99921, 0.99922, 0.99922, 0.99922, 0.99922, 0.99923, 0.99923, 0.99923, 0.99923, 0.99923, 0.99924, 0.99924, 0.99924, 0.99924, 0.99924, 0.99925, 0.99925, 0.99926, 0.99926, 0.99926, 0.99927, 0.99927, 0.99927, 0.99927, 0.99927, 0.99928, 0.99928, 0.99928, 0.99928, 0.99928, 0.99929, 0.99929, 0.99929, 0.99929, 0.99929, 0.9993, 0.9993, 0.9993, 0.9993, 0.9993, 0.99931, 0.99931, 0.99931, 0.99931, 0.99931, 0.99931, 0.99932, 0.99932, 0.99932, 0.99932, 0.99933, 0.99933, 0.99934, 0.99934, 0.99934, 0.99934, 0.99934, 0.99935, 0.99935, 0.99935, 0.99935, 0.99935, 0.99935, 0.99936, 0.99936, 0.99936, 0.99936, 0.99936, 0.99936, 0.99937, 0.99937, 0.99937, 0.99937, 0.99937, 0.99937, 0.99937, 0.99938, 0.99938, 0.99938, 0.99938, 0.99938, 0.99938, 0.99939, 0.99939, 0.99939, 0.99939, 0.99939, 0.99939, 0.99939, 0.9994, 0.99941, 0.99941, 0.99941, 0.99941, 0.99941, 0.99941, 0.99942, 0.99942, 0.99942, 0.99942, 0.99942, 0.99942, 0.99942, 0.99943, 0.99943, 0.99943, 0.99943, 0.99943, 0.99943, 0.99943, 0.99944, 0.99944, 0.99944, 0.99944, 0.99944, 0.99944, 0.99944, 0.99944, 0.99945, 0.99945, 0.99945, 0.99945, 0.99945, 0.99945, 0.99945, 0.99946, 0.99946, 0.99946, 0.99946, 0.99946, 0.99946};

int numElements = sizeof(mylar_x) / sizeof(mylar_x[0]); 

for (int i = 0; i < numElements; ++i) {
    mylar_y[i] *= 100.0;
  }
    
    
  c1-> cd(1)->SetMargin(0.135, 0.014, 0.15, 0.085);
  
  TGraph* graphP12 = new TGraph(npoints, energies, eff_P12);
  TGraph* graphP16 = new TGraph(npoints, energies, eff_P16);
  TGraph* graphP2 = new TGraph(npoints, energies, eff_P2);
  TGraph* graphP3 = new TGraph(npoints, energies, eff_P3);
  TGraph* graphM = new TGraph(numElements, mylar_x, mylar_y); //energies, mylar);
  
  TGraph* graphM_2 = new TGraph(numElements, mylar_x, mylar_y); 

  graphP12->SetMarkerStyle(20);
  graphP12->SetMarkerSize(1.4);
  graphP12->SetMarkerColor(kMagenta+2); 
  graphP12->SetLineColor(kMagenta+1); 
  graphP12->SetLineWidth(1);
  
  graphP16->SetMarkerStyle(20);
  graphP16->SetMarkerSize(1.4);
  graphP16->SetMarkerColor(kGreen+2); 
  graphP16->SetLineColor(kGreen+1); 
  graphP16->SetLineWidth(1); 

  graphP2->SetMarkerStyle(20);
  graphP2->SetMarkerSize(1.4);
  graphP2->SetMarkerColor(kAzure); 
  graphP2->SetLineColor(kAzure+7); 
  graphP2->SetLineWidth(1);  
  
  graphP3->SetMarkerStyle(20);
  graphP3->SetMarkerSize(1.4);
  graphP3->SetMarkerColor(kTeal-1); 
  graphP3->SetLineColor(kTeal-5); 
  graphP3->SetLineWidth(1); 

  graphM->SetMarkerStyle(22);
  graphM->SetMarkerSize(0.7);
  graphM->SetMarkerColor(kBlack);
  graphM->SetLineColor(kBlack);
  graphM->SetLineWidth(2);

    
  gStyle->SetTitleFont(102, ""); // set the pad title font
  // gStyle->SetTitleOffset(1.3); // set the pad title font

  graphM->SetTitle("3 cm Drift Distance");  
  graphM->GetXaxis()->SetTitle("Energy (keV)");         
  graphM->GetXaxis()->SetTitleSize(0.05);
  graphM->GetXaxis()->SetTitleFont(82);
  graphM->GetXaxis()->CenterTitle(); 
  graphM->GetXaxis()->SetLabelFont(82);
  graphM->GetXaxis()->SetTitleOffset(1.1);  
  graphM->GetXaxis()->SetLabelSize(0.0475); 
  graphM->GetYaxis()->SetTitle("Efficiency (%)");  
  graphM->GetYaxis()->SetTitleSize(0.05);
  graphM->GetYaxis()->SetTitleFont(82);
  graphM->GetYaxis()->SetLabelFont(82);
  graphM->GetYaxis()->SetTitleOffset(1.3);
  graphM->GetYaxis()->SetLabelOffset(0.02); 
  graphM->GetYaxis()->CenterTitle(); 
  graphM->GetYaxis()->SetLabelSize(0.0475); 
  graphM->GetYaxis()->SetRangeUser(0,100);
  graphM->GetXaxis()->SetRangeUser(0,16.2);
  
  graphM->Draw("APL");
  graphP16->Draw("PLsame");
  graphP2->Draw("PLsame");
  graphP3->Draw("PLsame");
  graphP12->Draw("PLsame");

  TLegend *legend = new TLegend(0.22,0.25,0.5,0.5);  //(0.78,0.63,0.95,0.88);
  legend->SetTextSize(0.035);
  legend->SetTextFont(82); 
  legend->AddEntry(graphM, "Mylar-Al 4 #mum", "pl");
  legend->AddEntry(graphP12,"P = 1.2 bar","pl");
  legend->AddEntry(graphP16,"P = 1.6 bar","pl");
  legend->AddEntry(graphP2, "P = 2.0 bar", "pl");
  legend->AddEntry(graphP3, "P = 3.0 bar", "pl");
  legend->SetFillColor(kWhite); 
  legend->SetLineColor(kWhite);
  legend->Draw(); 
  
  c1->cd(2)->SetMargin(0.135, 0.014, 0.15, 0.085);
  
  TGraph* graphP12L2 = new TGraph(npoints, energies, eff_P12L2);  
  TGraph* graphP2L2 = new TGraph(npoints, energies, eff_P2L2); 
  TGraph* graphP3L2 = new TGraph(npoints, energies, eff_P3L2);
  TGraph* graphP16L2 = new TGraph(npoints, energies, eff_P16L2); 
  
  graphP12L2->SetMarkerStyle(21);
  graphP12L2->SetMarkerSize(1.4);
  graphP12L2->SetMarkerColor(kMagenta+2); 
  graphP12L2->SetLineColor(kMagenta+1); 
  graphP12L2->SetLineWidth(1);
  
  graphP2L2->SetMarkerStyle(21);
  graphP2L2->SetMarkerSize(1.4);
  graphP2L2->SetMarkerColor(kAzure); 
  graphP2L2->SetLineColor(kAzure+7); 
  graphP2L2->SetLineWidth(1);
  
  graphP3L2->SetMarkerStyle(21);
  graphP3L2->SetMarkerSize(1.4);
  graphP3L2->SetMarkerColor(kTeal-1); 
  graphP3L2->SetLineColor(kTeal-5); 
  graphP3L2->SetLineWidth(1);
  
  graphP16L2->SetMarkerStyle(21);
  graphP16L2->SetMarkerSize(1.4);
  graphP16L2->SetMarkerColor(kGreen+2); 
  graphP16L2->SetLineColor(kGreen+1); 
  graphP16L2->SetLineWidth(1);
  
  graphM_2->SetMarkerStyle(22);
  graphM_2->SetMarkerSize(0.7);
  graphM_2->SetMarkerColor(kBlack);
  graphM_2->SetLineColor(kBlack);
  graphM_2->SetLineWidth(2);

  graphM_2->SetTitle("6 cm Drift Distance");  
  graphM_2->GetXaxis()->SetTitle("Energy (keV)");         
  graphM_2->GetXaxis()->SetTitleSize(0.05);
  graphM_2->GetXaxis()->SetTitleFont(82);
  graphM_2->GetXaxis()->CenterTitle(); 
  graphM_2->GetXaxis()->SetLabelFont(82);
  graphM_2->GetXaxis()->SetTitleOffset(1.1);  
  graphM_2->GetXaxis()->SetLabelSize(0.0475); 
  graphM_2->GetYaxis()->SetTitle("Efficiency (%)");  
  graphM_2->GetYaxis()->SetTitleSize(0.05);
  graphM_2->GetYaxis()->SetTitleFont(82);
  graphM_2->GetYaxis()->SetLabelFont(82);
  graphM_2->GetYaxis()->SetTitleOffset(1.3);
  graphM_2->GetYaxis()->SetLabelOffset(0.02); 
  graphM_2->GetYaxis()->CenterTitle(); 
  graphM_2->GetYaxis()->SetLabelSize(0.0475); 
  graphM_2->GetYaxis()->SetRangeUser(0,100);
  graphM_2->GetXaxis()->SetRangeUser(0,16.2);
  
  graphM_2->Draw("APL");
  graphP16L2->Draw("PLsame");
  graphP2L2->Draw("PLsame");
  graphP3L2->Draw("PLsame");
  graphP12L2->Draw("PLsame");

  TLegend *legend2 = new TLegend(0.22,0.25,0.5,0.5); 
  legend2->SetTextSize(0.035); 
  legend2->SetTextFont(82); 
  legend2->AddEntry(graphM, "Mylar-Al 4 #mum", "pl");
  legend2->AddEntry(graphP12L2, "P = 1.2 bar", "pl");
  legend2->AddEntry(graphP16L2, "P = 1.6 bar", "pl");
  legend2->AddEntry(graphP2L2, "P = 2.0 bar", "pl");
  legend2->AddEntry(graphP3L2, "P = 3.0 bar", "pl");
  legend2->SetFillColorAlpha(kWhite, 0);
  legend2->SetLineColor(kWhite);
  legend2->Draw(); 

  c1->SaveAs("efficiency_b.png");
  c1->SaveAs("efficiency_b.eps");
}


void comparison(){

  TCanvas * c1 = new TCanvas("c1", "c1", 3000, 1500); //4800, 1100 //2900, 2200
  c1 ->Divide(2,1);
  gStyle->SetTextFont(42);

  const int npoints=4;
  double pressures[npoints] = {1.2, 1.6, 2.0, 3.0};
  double eff_2keV[npoints] = {74.27267968, 75.41606505, 76.48600725, 77.2723732};
  double eff_3keV[npoints] = {58.01477486, 67.49183896, 74.34456929, 83.5151007};
  double eff_6keV[npoints] = {74.18023211, 82.18966847, 85.59502664, 94.122773};
  double eff_10keV[npoints] = {28.00598392, 36.33665717, 43.60313316, 58.3736156}; 
  double eff_145keV[npoints] = {11.23569763, 14.36860302, 17.98213654, 26.4166984};
  
  double eff_2keV_2[npoints] = {77.2766156, 76.8428975, 76.9069767, 77.2514802};
  double eff_3keV_2[npoints] = {79.6091623, 85.8734133,88.8362954, 91.1460715};
  double eff_6keV_2[npoints] = {91.3802924, 94.3502825, 95.8751723, 96.5831435};
  double eff_10keV_2[npoints] = {50.7074198, 60.7789567, 68.0609438, 82.6475548};
  double eff_145keV_2[npoints] = {21.3218585, 27.5684095, 33.2781218, 46.0201414};

  c1-> cd(1)->SetMargin(0.135, 0.005, 0.15, 0.085);
  
  TGraph* graph2keV = new TGraph(npoints, pressures, eff_2keV);
  TGraph* graph3keV = new TGraph(npoints, pressures, eff_3keV);
  TGraph* graph6keV = new TGraph(npoints, pressures, eff_6keV);
  TGraph* graph10keV = new TGraph(npoints, pressures, eff_10keV);
  TGraph* graph145keV = new TGraph(npoints, pressures, eff_145keV);
  
  graph2keV->SetMarkerStyle(20);
  graph2keV->SetMarkerSize(1.5);
  graph2keV->SetMarkerColor(kMagenta+2); 
  graph2keV->SetLineColor(kMagenta+1); 
  graph2keV->SetLineWidth(2);

  graph3keV->SetMarkerStyle(20);
  graph3keV->SetMarkerSize(1.5);
  graph3keV->SetMarkerColor(kAzure); 
  graph3keV->SetLineColor(kAzure+7); 
  graph3keV->SetLineWidth(2);
  
  graph6keV->SetMarkerStyle(20);
  graph6keV->SetMarkerSize(1.5);
  graph6keV->SetMarkerColor(kRed+1); 
  graph6keV->SetLineColor(kRed-4); 
  graph6keV->SetLineWidth(2);
  
  graph10keV->SetMarkerStyle(20);
  graph10keV->SetMarkerSize(1.5);
  graph10keV->SetMarkerColor(kGreen+2); 
  graph10keV->SetLineColor(kGreen+1); 
  graph10keV->SetLineWidth(2);
  
  graph145keV->SetMarkerStyle(20);
  graph145keV->SetMarkerSize(1.5);
  graph145keV->SetMarkerColor(kOrange+1); 
  graph145keV->SetLineColor(kOrange); 
  graph145keV->SetLineWidth(2);
  
  gStyle->SetTitleFont(102, ""); 
  graph2keV->SetTitle("3 cm Drift Distance");  
  graph2keV->GetXaxis()->SetTitle("Pressure (bar)");         
  graph2keV->GetXaxis()->SetTitleSize(0.05);
  graph2keV->GetXaxis()->SetTitleFont(82);
  graph2keV->GetXaxis()->CenterTitle(); 
  graph2keV->GetXaxis()->SetLabelFont(82);
  graph2keV->GetXaxis()->SetTitleOffset(1.1);  
  graph2keV->GetXaxis()->SetLabelSize(0.0475);
  graph2keV->GetYaxis()->SetTitle("Efficiency (%)");  
  graph2keV->GetYaxis()->SetTitleSize(0.05);
  graph2keV->GetYaxis()->SetTitleFont(82);
  graph2keV->GetYaxis()->SetLabelFont(82);
  graph2keV->GetYaxis()->SetTitleOffset(1.3);
  graph2keV->GetYaxis()->SetLabelOffset(0.02); 
  graph2keV->GetYaxis()->CenterTitle(); 
  graph2keV->GetYaxis()->SetLabelSize(0.0475); 
  graph2keV->GetYaxis()->SetRangeUser(0,100);
  
  graph2keV->Draw("APL");
  graph3keV->Draw("PLsame");
  graph6keV->Draw("PLsame");
  graph10keV->Draw("PLsame");
  graph145keV->Draw("PLsame");
  
  TLegend *legend = new TLegend(0.68,0.37,0.90,0.52);  
  legend->SetTextSize(0.035);
  legend->SetTextFont(82); 
  legend->AddEntry(graph2keV, "E = 2keV", "p");
  legend->AddEntry(graph3keV, "E = 3keV", "p");
  legend->AddEntry(graph6keV, "E = 6keV", "p");
  legend->AddEntry(graph10keV, "E = 10keV", "p");
  legend->AddEntry(graph145keV, "E = 14.5keV", "p");
  legend->SetFillColorAlpha(kWhite, 0);  
  legend->SetLineColor(kWhite);
  legend->Draw(); 
  
  
  c1->cd(2)->SetMargin(0.135, 0.005, 0.15, 0.085);
  
  TGraph* graph2keV_2 = new TGraph(npoints, pressures, eff_2keV_2);
  TGraph* graph3keV_2 = new TGraph(npoints, pressures, eff_3keV_2);
  TGraph* graph6keV_2 = new TGraph(npoints, pressures, eff_6keV_2);
  TGraph* graph10keV_2 = new TGraph(npoints, pressures, eff_10keV_2);
  TGraph* graph145keV_2 = new TGraph(npoints, pressures, eff_145keV_2);
  
  graph2keV_2->SetMarkerStyle(20);
  graph2keV_2->SetMarkerSize(1.5);
  graph2keV_2->SetMarkerColor(kMagenta+2); 
  graph2keV_2->SetLineColor(kMagenta+1); 
  graph2keV_2->SetLineWidth(2);

  graph3keV_2->SetMarkerStyle(20);
  graph3keV_2->SetMarkerSize(1.5);
  graph3keV_2->SetMarkerColor(kAzure); 
  graph3keV_2->SetLineColor(kAzure+7); 
  graph3keV_2->SetLineWidth(2);
  
  graph6keV_2->SetMarkerStyle(20);
  graph6keV_2->SetMarkerSize(1.5);
  graph6keV_2->SetMarkerColor(kRed+1); 
  graph6keV_2->SetLineColor(kRed-4); 
  graph6keV_2->SetLineWidth(2);
  
  graph10keV_2->SetMarkerStyle(20);
  graph10keV_2->SetMarkerSize(1.5);
  graph10keV_2->SetMarkerColor(kGreen+2); 
  graph10keV_2->SetLineColor(kGreen+1); 
  graph10keV_2->SetLineWidth(2);
  
  graph145keV_2->SetMarkerStyle(20);
  graph145keV_2->SetMarkerSize(1.5);
  graph145keV_2->SetMarkerColor(kOrange+1); 
  graph145keV_2->SetLineColor(kOrange); 
  graph145keV_2->SetLineWidth(2);
  
  gStyle->SetTitleX(0.57); //title X location
  gStyle->SetTitleY(0.99); //title Y location
  gStyle->SetTitleSize(0.075, "t");  
  graph2keV_2->SetTitle("6 cm Drift Distance"); 
  graph2keV_2->GetXaxis()->SetTitle("Pressure (bar)");         
  graph2keV_2->GetXaxis()->SetTitleSize(0.05);
  graph2keV_2->GetXaxis()->SetTitleFont(82);
  graph2keV_2->GetXaxis()->SetTitleOffset(1.1);
  graph2keV_2->GetXaxis()->CenterTitle(); 
  graph2keV_2->GetXaxis()->SetLabelSize(0.0475);
  graph2keV_2->GetXaxis()->SetLabelFont(82);
  graph2keV_2->GetYaxis()->SetTitle("Efficiency (%)");  
  graph2keV_2->GetYaxis()->SetTitleSize(0.05);
  graph2keV_2->GetYaxis()->SetTitleFont(82);
  graph2keV_2->GetYaxis()->SetTitleOffset(1.3); 
  graph2keV_2->GetYaxis()->CenterTitle(); 
  graph2keV_2->GetYaxis()->SetLabelSize(0.0475);
  graph2keV_2->GetYaxis()->SetLabelFont(82);
  graph2keV_2->GetYaxis()->SetLabelOffset(0.02); 
  graph2keV_2->GetYaxis()->SetRangeUser(0,100);
  
  graph2keV_2->Draw("APL");
  graph3keV_2->Draw("PLsame");
  graph6keV_2->Draw("PLsame");
  graph10keV_2->Draw("PLsame");
  graph145keV_2->Draw("PLsame");
  
  TLegend *legend2 = new TLegend(0.68,0.21,0.90,0.36);   
  legend2->SetTextSize(0.035);
  legend2->SetTextFont(82);  
  legend2->AddEntry(graph2keV, "E = 2keV", "p");
  legend2->AddEntry(graph3keV, "E = 3keV", "p");
  legend2->AddEntry(graph6keV, "E = 6keV", "p");
  legend2->AddEntry(graph10keV, "E = 10keV", "p");
  legend2->AddEntry(graph145keV, "E = 14.5keV", "p");
  legend2->SetFillColorAlpha(kWhite, 0); 
  legend2->SetLineColor(kWhite);
  legend2->Draw(); 
  
//  TF1* fitFunc = new TF1("fitFunc", "pol2"); 
//  graph145keV_2->Fit(fitFunc, "same"); 
//  fitFunc->Draw("same");

  c1->SaveAs("comparison_of_eff.png"); 
  c1->SaveAs("comparison_of_eff.eps");
}


void efficiency_fits(){

  TCanvas * c1 = new TCanvas("c1", "c1", 2600, 1500); 
  c1 ->Divide(1,2);

  const int npoints=65;
  double energies[npoints] = {0.0, 0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0, 2.25, 2.5, 2.75, 3.0, 3.25, 3.5, 3.75, 4.0, 4.25, 4.5, 4.75, 5.0, 5.25, 5.5, 5.75, 6.0, 6.25, 6.5, 6.75, 7.0, 7.25, 7.5, 7.75, 8.0, 8.25, 8.5, 8.75, 9.0, 9.25, 9.5, 9.75, 10.0, 10.25, 10.5, 10.75, 11.0, 11.25, 11.5, 11.75, 12.0, 12.25, 12.5, 12.75, 13.0, 13.25, 13.5, 13.75, 14.0, 14.25, 14.5, 14.75, 15.0, 15.25, 15.5, 15.75, 16.0};

  double eff_P12[npoints] = {0.0, 4.503170479, 0.527532757, 3.097749901, 19.56004171, 41.19834711, 57.89595913, 67.3463839, 74.27267968, 73.72219329, 70.71972663, 64.31303897, 58.01477486, 87.91043372, 89.20303605, 90.04585403, 91.02158273, 90.3750952, 89.69685523, 87.43088832, 85.07019438, 83.71048692, 80.38487508, 77.47395833, 74.18023211, 69.90262614, 66.57090807, 63.20660497, 59.38831787, 56.7674349, 52.5440694, 50.13252757, 47.49912382, 44.21096967, 41.52080218, 39.14643729, 36.37010676, 34.53561426, 32.19676789, 30.84477368, 28.00598392, 26.88488194, 25.70105554, 24.19350448, 22.99709423, 21.48402948, 20.48501068, 19.39766331, 18.18028502, 17.17038722, 16.38648197, 15.63166017, 14.9892896, 13.9834574, 13.35714172, 12.52487187, 11.95756292, 11.33586469, 11.23569763, 10.51281721, 10.071068, 9.633601852, 9.166380789, 8.545489583, 8.279174908};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P12[i] *= 0.01;
  }

  double eff_P2[npoints] = {0.0, 4.486343549, 0.528649917, 3.11730489, 19.53250835, 41.21344969, 57.42500144, 68.5607373, 76.48600725, 80.46051565, 81.07049608, 79.84906872, 74.34456929, 89.25401322, 91.15763311, 91.5475391, 92.68623462, 93.23023052, 93.24902724, 93.0273097, 92.97940238, 92.83720035, 91.54342055, 89.92255295, 85.59502664, 85.63943162, 83.19799585, 80.8377226, 77.70808203, 74.79409479, 71.88761022, 68.71568138, 66.15998349, 62.85957113, 59.83983114, 57.15640372, 54.21631531, 51.31118881, 48.85559717, 46.15840118, 43.60313316, 41.52892562, 39.2594169, 37.6159102, 35.76505507, 34.087858, 31.68972159, 30.320075, 28.75231822, 27.96751482, 26.23213765, 25.24840262, 23.9957831, 22.77636022, 21.88841202, 20.83589719, 19.62332928, 18.8472312, 17.98213654, 17.22365553, 16.32894486, 15.68179742, 15.02237412, 14.23021946, 13.69651951};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P2[i] *= 0.01;
  }
  
  double eff_P3[npoints] = {0.0, 4.499523356, 0.528518774, 3.125088531, 19.59775214, 40.85350841, 58.26951184, 68.94150418, 77.27237324, 82.40955858, 85.52371116, 86.56508489, 83.51510067, 89.62851216, 90.74814392, 91.95236723, 93.15982972, 94.15780747, 93.72927638, 95.0377562, 94.38950357, 95.42907697, 94.69978486, 94.88630819, 94.12277304, 93.07015867, 92.14184397, 90.83356669, 89.25096383, 87.03239664, 84.91026311, 82.58179352, 79.7704918, 76.91882502, 74.59330878, 71.28857686, 68.23005093, 66.00397614, 62.852078, 61.02753697, 58.37361562, 55.71337098, 52.64622405, 50.66816335, 49.00237775, 46.24913971, 43.72566496, 42.61205916, 40.82230087, 38.67825942, 37.02611122, 35.47817407, 33.99400954, 32.7702219, 30.76018282, 29.22922923, 28.27627289, 27.16611396, 26.41669843, 24.81577927, 23.69562325, 23.16450115, 22.12431353, 21.07365318, 20.11922504};

  for (int i = 0; i < npoints; ++i) {
    eff_P3[i] *= 0.01;
  }
  
  double eff_P12L2[npoints] = {0.0, 4.505114491, 0.527807219, 3.095495136, 19.57647986, 41.14563988, 57.89106956, 68.5131397, 77.2766156, 82.35879572, 84.25784563, 83.19805874, 79.60916226, 88.74222138, 89.73969219, 91.58482573, 92.48689575, 93.17054188, 93.77751688, 93.65825015, 93.80496385, 93.75792451, 93.24992726, 92.6552586, 91.38029239, 89.23148148, 87.40243238, 84.95816821, 83.17676463, 81.52403481, 78.13032541, 74.94000155, 72.47651259, 69.77652419, 66.20153973, 63.11555817, 60.15842839, 57.21627668, 54.51016743, 52.53386854, 50.70741981, 46.39006211, 45.40927332, 43.15852923, 40.85746985, 39.03979785, 37.05981669, 35.05398497, 34.14051714, 31.76359371, 30.79106545, 29.16103277, 28.18548387, 26.80173489, 25.62115797, 24.4720531, 22.86692936, 21.89851485, 21.32185853, 20.26073161, 19.2427146, 18.78754076, 17.94776887, 16.98250015, 16.39557457};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P12L2[i] *= 0.01;
  }
  
  double eff_P2L2[npoints] = {0.0, 4.486567015, 0.529380283, 3.115396809, 19.47889117, 41.22440538, 57.48458124, 68.55162855, 76.90697674, 82.94761467, 86.66666667, 88.38841507, 88.83629544, 89.4513174, 91.00276691, 91.86827957, 92.86959891, 93.85214008, 93.66718628, 94.52014508, 95.00147304, 95.46440544, 96.08888889, 95.53342536, 95.87517228, 95.93080401, 95.41678882, 94.1937977, 93.64228265, 92.50592136, 90.92350746, 89.89073547, 87.71882575, 85.64044156, 83.77684607, 81.51456959, 78.88924976, 76.41605782, 73.78774016, 71.31377175, 68.06094378, 66.71986677, 63.40414268, 61.33981079, 58.69899686, 56.3093063, 54.29272748, 51.73631868, 50.05023, 47.80983176, 46.219763, 43.74183921, 42.36727668, 40.86634741, 39.87056119, 37.90506432, 36.11261715, 34.62591412, 33.27812185, 31.64408591, 30.72024008, 29.73763776, 28.3161512, 27.03765491, 26.61243123};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P2L2[i] *= 0.01;
  }
  
  double eff_P3L2[npoints] = {0.0, 4.494193507, 0.528746747, 3.11395351, 19.56945621, 40.89452932, 58.32650673, 68.91101518, 77.25148021, 82.86214661, 87.03265914, 90.15412511, 91.14607153, 89.45783133, 91.16722249, 91.77372963, 93.33462507, 94.03057747, 93.79269959, 95.22733968, 95.01080338, 95.982231, 95.8678501, 96.32556302, 96.58314351, 96.69339669, 96.82209682, 96.88519727, 96.48741983, 96.61417323, 95.95692609, 95.30885781, 94.92081885, 93.8305797, 92.93139293, 91.086454, 90.43846721, 88.44592766, 86.40571277, 84.51457148, 82.64755481, 80.26802598, 78.36970475, 76.22925149, 73.84802247, 71.11176169, 69.59657265, 66.8228162, 65.2984067, 63.52925689, 60.9407468, 58.83253706, 56.11510791, 55.22937892, 53.17504448, 51.59166936, 48.58221134, 47.03727538, 46.02014138, 44.07662265, 43.17146501, 40.97019796, 39.88709198, 37.81208539, 36.93515924};

  for (int i = 0; i < npoints; ++i) {
    eff_P3L2[i] *= 0.01;
  }
  
  c1-> cd(1)->SetMargin(0.1, 0.1, 0.1, 0.1);
  
  TGraph* graphP12 = new TGraph(npoints, energies, eff_P12);
  TGraph* graphP2 = new TGraph(npoints, energies, eff_P2);
  TGraph* graphP3 = new TGraph(npoints, energies, eff_P3);
  
  graphP12->SetMarkerStyle(20);
  graphP12->SetMarkerSize(1.3);
  graphP12->SetMarkerColor(kMagenta+2); 
  graphP12->SetLineColor(kMagenta+1); 
  graphP12->SetLineWidth(1);

  graphP2->SetMarkerStyle(20);
  graphP2->SetMarkerSize(1.3);
  graphP2->SetMarkerColor(kAzure); 
  graphP2->SetLineColor(kAzure+7); 
  graphP2->SetLineWidth(1);  
  
  graphP3->SetMarkerStyle(20);
  graphP3->SetMarkerSize(1.3);
  graphP3->SetMarkerColor(kTeal-1); 
  graphP3->SetLineColor(kTeal-5); 
  graphP3->SetLineWidth(1); 
    
  graphP12->SetTitle("");  
  graphP12->GetXaxis()->SetTitle("Energy (keV)");         
  graphP12->GetXaxis()->SetTitleSize(0.043); 
  graphP12->GetXaxis()->SetTitleOffset(1.1);  
  graphP12->GetXaxis()->SetLabelSize(0.045); 
  graphP12->GetYaxis()->SetTitle("Efficiency (%) for L=l");  
  graphP12->GetYaxis()->SetTitleSize(0.043); 
  graphP12->GetYaxis()->SetTitleOffset(0.8); 
  graphP12->GetYaxis()->SetLabelSize(0.04); 
  graphP12->GetYaxis()->SetRangeUser(0,1);
  
  graphP12->Draw("APL");
  graphP2->Draw("PLsame");
  graphP3->Draw("PLsame");
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc12_1 = new TF1("fitFunc12_1", "pol6", 0.75, 3.0);
  TF1* fitFunc12_2 = new TF1("fitFunc12_2", "pol1", 3.0, 3.25);
  TF1* fitFunc12_3 = new TF1("fitFunc12_3", "pol5", 3.25, 16.01);

  // Perform fits
  graphP12->Fit(fitFunc12_1, "R+");
  graphP12->Fit(fitFunc12_2, "R+");
  graphP12->Fit(fitFunc12_3, "R+");

  fitFunc12_1->SetLineColor(kBlack); 
  fitFunc12_1->Draw("sameL");
  fitFunc12_2->SetLineColor(kBlue); 
  fitFunc12_2->Draw("sameL");
  fitFunc12_3->SetLineColor(kRed); 
  fitFunc12_3->Draw("sameL");
  
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_1 = new TF1("fitFunc2_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_2 = new TF1("fitFunc2_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_3 = new TF1("fitFunc2_3", "pol6", 3.25, 16.01);

  // Perform fits
  graphP2->Fit(fitFunc2_1, "R+");
  graphP2->Fit(fitFunc2_2, "R+");
  graphP2->Fit(fitFunc2_3, "R+");

  fitFunc2_1->SetLineColor(kBlack); 
  fitFunc2_1->Draw("sameL");
  fitFunc2_2->SetLineColor(kBlue); 
  fitFunc2_2->Draw("sameL");
  fitFunc2_3->SetLineColor(kRed); 
  fitFunc2_3->Draw("sameL");
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc3_1 = new TF1("fitFunc3_1", "pol6", 0.75, 3.0);
  TF1* fitFunc3_2 = new TF1("fitFunc3_2", "pol1", 3.0, 3.25);
  TF1* fitFunc3_3 = new TF1("fitFunc3_3", "pol6", 3.25, 16.01);

  // Perform fits
  graphP3->Fit(fitFunc3_1, "R+");
  graphP3->Fit(fitFunc3_2, "R+");
  graphP3->Fit(fitFunc3_3, "R+");

  fitFunc3_1->SetLineColor(kBlack); 
  fitFunc3_1->Draw("sameL");
  fitFunc3_2->SetLineColor(kBlue); 
  fitFunc3_2->Draw("sameL");
  fitFunc3_3->SetLineColor(kRed); 
  fitFunc3_3->Draw("sameL");
  
  // Para comprobar:
  double x = 3.2502891757210706; 
  double value = fitFunc2_3->Eval(x);  //cuidado con el ndice!!!
  std::cout << "Value of the fit function at x = " << x << " is " << value << std::endl;
  
  TLegend *legend = new TLegend(0.8,0.75,0.86,0.86);  
  legend->SetTextSize(0.03); 
  legend->AddEntry(graphP12,"P = 1.2 bar","p");
  legend->AddEntry(graphP2, "P = 2.0 bar", "p");
  legend->AddEntry(graphP3, "P = 3.0 bar", "p");
  legend->SetFillColor(kWhite); 
  legend->Draw(); 
  
  c1->cd(2)->SetMargin(0.1, 0.1, 0.1, 0.1);
  
  TGraph* graphP12L2 = new TGraph(npoints, energies, eff_P12L2);  
  TGraph* graphP2L2 = new TGraph(npoints, energies, eff_P2L2); 
  TGraph* graphP3L2 = new TGraph(npoints, energies, eff_P3L2);
  
  graphP12L2->SetMarkerStyle(20);
  graphP12L2->SetMarkerSize(1.3);
  graphP12L2->SetMarkerColor(kMagenta+2); 
  graphP12L2->SetLineColor(kMagenta+1); 
  graphP12L2->SetLineWidth(1);
  
  graphP2L2->SetMarkerStyle(20);
  graphP2L2->SetMarkerSize(1.3);
  graphP2L2->SetMarkerColor(kAzure); 
  graphP2L2->SetLineColor(kAzure+7); 
  graphP2L2->SetLineWidth(1);
  
  graphP3L2->SetMarkerStyle(20);
  graphP3L2->SetMarkerSize(1.3);
  graphP3L2->SetMarkerColor(kTeal-1); 
  graphP3L2->SetLineColor(kTeal-5); 
  graphP3L2->SetLineWidth(1);
  
  graphP12L2->SetTitle("");  
  graphP12L2->GetXaxis()->SetTitle("Energy (keV)");         
  graphP12L2->GetXaxis()->SetTitleSize(0.043); 
  graphP12L2->GetXaxis()->SetTitleOffset(1.1);  
  graphP12L2->GetXaxis()->SetLabelSize(0.045); 
  graphP12L2->GetYaxis()->SetTitle("Efficiency (%) for L=2l");  
  graphP12L2->GetYaxis()->SetTitleSize(0.043); 
  graphP12L2->GetYaxis()->SetTitleOffset(0.8); 
  graphP12L2->GetYaxis()->SetLabelSize(0.04); 
  graphP12L2->GetYaxis()->SetRangeUser(0,1);
  
  graphP12L2->Draw("APL");
  graphP2L2->Draw("PLsame");
  graphP3L2->Draw("PLsame");
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_12_1 = new TF1("fitFunc2_12_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_12_2 = new TF1("fitFunc2_12_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_12_3 = new TF1("fitFunc2_12_3", "pol6", 3.25, 16.0);

  // Perform fits
  graphP12L2->Fit(fitFunc2_12_1, "R+");
  graphP12L2->Fit(fitFunc2_12_2, "R+");
  graphP12L2->Fit(fitFunc2_12_3, "R+");

  fitFunc2_12_1->SetLineColor(kBlack); 
  fitFunc2_12_1->Draw("sameL");
  fitFunc2_12_2->SetLineColor(kBlue); 
  fitFunc2_12_2->Draw("sameL");
  fitFunc2_12_3->SetLineColor(kRed); 
  fitFunc2_12_3->Draw("sameL");
  
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_2_1 = new TF1("fitFunc2_2_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_2_2 = new TF1("fitFunc2_2_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_2_3 = new TF1("fitFunc2_2_3", "pol6", 3.25, 16.0);

  // Perform fits
  graphP2L2->Fit(fitFunc2_2_1, "R+");
  graphP2L2->Fit(fitFunc2_2_2, "R+");
  graphP2L2->Fit(fitFunc2_2_3, "R+");

  fitFunc2_2_1->SetLineColor(kBlack); 
  fitFunc2_2_1->Draw("sameL");
  fitFunc2_2_2->SetLineColor(kBlue); 
  fitFunc2_2_2->Draw("sameL");
  fitFunc2_2_3->SetLineColor(kRed); 
  fitFunc2_2_3->Draw("sameL");
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_3_1 = new TF1("fitFunc2_3_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_3_2 = new TF1("fitFunc2_3_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_3_3 = new TF1("fitFunc2_3_3", "pol6", 3.25, 16.01);

  // Perform fits
  graphP3L2->Fit(fitFunc2_3_1, "R+");
  graphP3L2->Fit(fitFunc2_3_2, "R+");
  graphP3L2->Fit(fitFunc2_3_3, "R+");

  fitFunc2_3_1->SetLineColor(kBlack); 
  fitFunc2_3_1->Draw("sameL");
  fitFunc2_3_2->SetLineColor(kBlue); 
  fitFunc2_3_2->Draw("sameL");
  fitFunc2_3_3->SetLineColor(kRed); 
  fitFunc2_3_3->Draw("sameL");
//  
//  // Para comprobar:
//  double x2 = 3.2502891757210706; 
//  double value2 = fitFunc2_2_3->Eval(x);  //cuidado con el ndice!!!
//  std::cout << "Value of the fit function at x = " << x2 << " is " << value2 << std::endl;
  
  
  TLegend *legend2 = new TLegend(0.13,0.75,0.19,0.86);  
  legend2->SetTextSize(0.03); 
  legend2->AddEntry(graphP12L2, "P = 1.2 bar", "p");
  legend2->AddEntry(graphP2L2, "P = 2.0 bar", "p");
  legend2->AddEntry(graphP3L2, "P = 3.0 bar", "p");
  legend2->SetFillColor(kWhite); 
  legend2->Draw(); 

  c1->SaveAs("efficiency_fits.png");  
  c1->SaveAs("efficiency_fits.eps");
  
  TFile * fout = new TFile("Fit_file.root", "recreate"); 
  fitFunc12_1->Write();  
  fitFunc12_2->Write();
  fitFunc12_3->Write();
  fitFunc2_1->Write();  
  fitFunc2_2->Write(); 
  fitFunc2_3->Write();
  fitFunc3_1->Write();  
  fitFunc3_2->Write();
  fitFunc3_3->Write();  //una funcin void hasta aqu, con dos ifs, uno dentro del otro
  
  fitFunc2_12_1->Write();  
  fitFunc2_12_2->Write();
  fitFunc2_12_3->Write();
  fitFunc2_2_1->Write();  
  fitFunc2_2_2->Write();
  fitFunc2_2_3->Write();
  fitFunc2_3_1->Write();  
  fitFunc2_3_2->Write();
  fitFunc2_3_3->Write();  //otra funcin void hasta aqu, como la anterior pero para L=2l
  fout->Close(); 
  
}



void efficiency_fits_new(){

  TCanvas * c1 = new TCanvas("c1", "c1", 2600, 1500); 
  c1 ->Divide(1,2);

  const int npoints=65;
  double energies[npoints] = {0.0, 0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0, 2.25, 2.5, 2.75, 3.0, 3.25, 3.5, 3.75, 4.0, 4.25, 4.5, 4.75, 5.0, 5.25, 5.5, 5.75, 6.0, 6.25, 6.5, 6.75, 7.0, 7.25, 7.5, 7.75, 8.0, 8.25, 8.5, 8.75, 9.0, 9.25, 9.5, 9.75, 10.0, 10.25, 10.5, 10.75, 11.0, 11.25, 11.5, 11.75, 12.0, 12.25, 12.5, 12.75, 13.0, 13.25, 13.5, 13.75, 14.0, 14.25, 14.5, 14.75, 15.0, 15.25, 15.5, 15.75, 16.0};

  double eff_P12[npoints] = {0.0, 4.503170479, 0.527532757, 3.097749901, 19.56004171, 41.19834711, 57.89595913, 67.3463839, 74.27267968, 73.72219329, 70.71972663, 64.31303897, 58.01477486, 87.91043372, 89.20303605, 90.04585403, 91.02158273, 90.3750952, 89.69685523, 87.43088832, 85.07019438, 83.71048692, 80.38487508, 77.47395833, 74.18023211, 69.90262614, 66.57090807, 63.20660497, 59.38831787, 56.7674349, 52.5440694, 50.13252757, 47.49912382, 44.21096967, 41.52080218, 39.14643729, 36.37010676, 34.53561426, 32.19676789, 30.84477368, 28.00598392, 26.88488194, 25.70105554, 24.19350448, 22.99709423, 21.48402948, 20.48501068, 19.39766331, 18.18028502, 17.17038722, 16.38648197, 15.63166017, 14.9892896, 13.9834574, 13.35714172, 12.52487187, 11.95756292, 11.33586469, 11.23569763, 10.51281721, 10.071068, 9.633601852, 9.166380789, 8.545489583, 8.279174908};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P12[i] *= 0.01;
  }

  double eff_P2[npoints] = {0.0, 4.486343549, 0.528649917, 3.11730489, 19.53250835, 41.21344969, 57.42500144, 68.5607373, 76.48600725, 80.46051565, 81.07049608, 79.84906872, 74.34456929, 89.25401322, 91.15763311, 91.5475391, 92.68623462, 93.23023052, 93.24902724, 93.0273097, 92.97940238, 92.83720035, 91.54342055, 89.92255295, 85.59502664, 85.63943162, 83.19799585, 80.8377226, 77.70808203, 74.79409479, 71.88761022, 68.71568138, 66.15998349, 62.85957113, 59.83983114, 57.15640372, 54.21631531, 51.31118881, 48.85559717, 46.15840118, 43.60313316, 41.52892562, 39.2594169, 37.6159102, 35.76505507, 34.087858, 31.68972159, 30.320075, 28.75231822, 27.96751482, 26.23213765, 25.24840262, 23.9957831, 22.77636022, 21.88841202, 20.83589719, 19.62332928, 18.8472312, 17.98213654, 17.22365553, 16.32894486, 15.68179742, 15.02237412, 14.23021946, 13.69651951};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P2[i] *= 0.01;
  }
  
  double eff_P3[npoints] = {0.0, 4.499523356, 0.528518774, 3.125088531, 19.59775214, 40.85350841, 58.26951184, 68.94150418, 77.27237324, 82.40955858, 85.52371116, 86.56508489, 83.51510067, 89.62851216, 90.74814392, 91.95236723, 93.15982972, 94.15780747, 93.72927638, 95.0377562, 94.38950357, 95.42907697, 94.69978486, 94.88630819, 94.12277304, 93.07015867, 92.14184397, 90.83356669, 89.25096383, 87.03239664, 84.91026311, 82.58179352, 79.7704918, 76.91882502, 74.59330878, 71.28857686, 68.23005093, 66.00397614, 62.852078, 61.02753697, 58.37361562, 55.71337098, 52.64622405, 50.66816335, 49.00237775, 46.24913971, 43.72566496, 42.61205916, 40.82230087, 38.67825942, 37.02611122, 35.47817407, 33.99400954, 32.7702219, 30.76018282, 29.22922923, 28.27627289, 27.16611396, 26.41669843, 24.81577927, 23.69562325, 23.16450115, 22.12431353, 21.07365318, 20.11922504};

  for (int i = 0; i < npoints; ++i) {
    eff_P3[i] *= 0.01;
  }
  
  double eff_P12L2[npoints] = {0.0, 4.505114491, 0.527807219, 3.095495136, 19.57647986, 41.14563988, 57.89106956, 68.5131397, 77.2766156, 82.35879572, 84.25784563, 83.19805874, 79.60916226, 88.74222138, 89.73969219, 91.58482573, 92.48689575, 93.17054188, 93.77751688, 93.65825015, 93.80496385, 93.75792451, 93.24992726, 92.6552586, 91.38029239, 89.23148148, 87.40243238, 84.95816821, 83.17676463, 81.52403481, 78.13032541, 74.94000155, 72.47651259, 69.77652419, 66.20153973, 63.11555817, 60.15842839, 57.21627668, 54.51016743, 52.53386854, 50.70741981, 46.39006211, 45.40927332, 43.15852923, 40.85746985, 39.03979785, 37.05981669, 35.05398497, 34.14051714, 31.76359371, 30.79106545, 29.16103277, 28.18548387, 26.80173489, 25.62115797, 24.4720531, 22.86692936, 21.89851485, 21.32185853, 20.26073161, 19.2427146, 18.78754076, 17.94776887, 16.98250015, 16.39557457};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P12L2[i] *= 0.01;
  }
  
  double eff_P2L2[npoints] = {0.0, 4.486567015, 0.529380283, 3.115396809, 19.47889117, 41.22440538, 57.48458124, 68.55162855, 76.90697674, 82.94761467, 86.66666667, 88.38841507, 88.83629544, 89.4513174, 91.00276691, 91.86827957, 92.86959891, 93.85214008, 93.66718628, 94.52014508, 95.00147304, 95.46440544, 96.08888889, 95.53342536, 95.87517228, 95.93080401, 95.41678882, 94.1937977, 93.64228265, 92.50592136, 90.92350746, 89.89073547, 87.71882575, 85.64044156, 83.77684607, 81.51456959, 78.88924976, 76.41605782, 73.78774016, 71.31377175, 68.06094378, 66.71986677, 63.40414268, 61.33981079, 58.69899686, 56.3093063, 54.29272748, 51.73631868, 50.05023, 47.80983176, 46.219763, 43.74183921, 42.36727668, 40.86634741, 39.87056119, 37.90506432, 36.11261715, 34.62591412, 33.27812185, 31.64408591, 30.72024008, 29.73763776, 28.3161512, 27.03765491, 26.61243123};
  
  for (int i = 0; i < npoints; ++i) {
    eff_P2L2[i] *= 0.01;
  }
  
  double eff_P3L2[npoints] = {0.0, 4.494193507, 0.528746747, 3.11395351, 19.56945621, 40.89452932, 58.32650673, 68.91101518, 77.25148021, 82.86214661, 87.03265914, 90.15412511, 91.14607153, 89.45783133, 91.16722249, 91.77372963, 93.33462507, 94.03057747, 93.79269959, 95.22733968, 95.01080338, 95.982231, 95.8678501, 96.32556302, 96.58314351, 96.69339669, 96.82209682, 96.88519727, 96.48741983, 96.61417323, 95.95692609, 95.30885781, 94.92081885, 93.8305797, 92.93139293, 91.086454, 90.43846721, 88.44592766, 86.40571277, 84.51457148, 82.64755481, 80.26802598, 78.36970475, 76.22925149, 73.84802247, 71.11176169, 69.59657265, 66.8228162, 65.2984067, 63.52925689, 60.9407468, 58.83253706, 56.11510791, 55.22937892, 53.17504448, 51.59166936, 48.58221134, 47.03727538, 46.02014138, 44.07662265, 43.17146501, 40.97019796, 39.88709198, 37.81208539, 36.93515924};

  for (int i = 0; i < npoints; ++i) {
    eff_P3L2[i] *= 0.01;
  }
  
  c1-> cd(1)->SetMargin(0.1, 0.1, 0.1, 0.1);
  
  TGraph* graphP12 = new TGraph(npoints, energies, eff_P12);
  TGraph* graphP2 = new TGraph(npoints, energies, eff_P2);
  TGraph* graphP3 = new TGraph(npoints, energies, eff_P3);
  
  graphP12->SetMarkerStyle(20);
  graphP12->SetMarkerSize(1.3);
  graphP12->SetMarkerColor(kMagenta+2); 
  graphP12->SetLineColor(kMagenta+1); 
  graphP12->SetLineWidth(1);

  graphP2->SetMarkerStyle(20);
  graphP2->SetMarkerSize(1.3);
  graphP2->SetMarkerColor(kAzure); 
  graphP2->SetLineColor(kAzure+7); 
  graphP2->SetLineWidth(1);  
  
  graphP3->SetMarkerStyle(20);
  graphP3->SetMarkerSize(1.3);
  graphP3->SetMarkerColor(kTeal-1); 
  graphP3->SetLineColor(kTeal-5); 
  graphP3->SetLineWidth(1); 
    
  graphP12->SetTitle("");  
  graphP12->GetXaxis()->SetTitle("Energy (keV)");         
  graphP12->GetXaxis()->SetTitleSize(0.043); 
  graphP12->GetXaxis()->SetTitleOffset(1.1);  
  graphP12->GetXaxis()->SetLabelSize(0.045); 
  graphP12->GetYaxis()->SetTitle("Efficiency (%) for L=l");  
  graphP12->GetYaxis()->SetTitleSize(0.043); 
  graphP12->GetYaxis()->SetTitleOffset(0.8); 
  graphP12->GetYaxis()->SetLabelSize(0.04); 
  graphP12->GetYaxis()->SetRangeUser(0,1);
  
  graphP12->Draw("APL");
  graphP2->Draw("PLsame");
  graphP3->Draw("PLsame");
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc12_1 = new TF1("fitFunc12_1", "pol6", 0.75, 3.0);
  TF1* fitFunc12_2 = new TF1("fitFunc12_2", "pol1", 3.0, 3.25);
  TF1* fitFunc12_3 = new TF1("fitFunc12_3", "pol5", 3.25, 16.01);

  // Perform fits
  graphP12->Fit(fitFunc12_1, "R+");
  graphP12->Fit(fitFunc12_2, "R+");
  graphP12->Fit(fitFunc12_3, "R+");

  fitFunc12_1->SetLineColor(kBlack); 
  fitFunc12_1->Draw("sameL");
  fitFunc12_2->SetLineColor(kBlue); 
  fitFunc12_2->Draw("sameL");
  fitFunc12_3->SetLineColor(kRed); 
  fitFunc12_3->Draw("sameL");
  
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_1 = new TF1("fitFunc2_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_2 = new TF1("fitFunc2_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_3 = new TF1("fitFunc2_3", "pol6", 3.25, 16.01);

  // Perform fits
  graphP2->Fit(fitFunc2_1, "R+");
  graphP2->Fit(fitFunc2_2, "R+");
  graphP2->Fit(fitFunc2_3, "R+");

  fitFunc2_1->SetLineColor(kBlack); 
  fitFunc2_1->Draw("sameL");
  fitFunc2_2->SetLineColor(kBlue); 
  fitFunc2_2->Draw("sameL");
  fitFunc2_3->SetLineColor(kRed); 
  fitFunc2_3->Draw("sameL");
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc3_1 = new TF1("fitFunc3_1", "pol6", 0.75, 3.0);
  TF1* fitFunc3_2 = new TF1("fitFunc3_2", "pol1", 3.0, 3.25);
  TF1* fitFunc3_3 = new TF1("fitFunc3_3", "pol6", 3.25, 16.01);

  // Perform fits
  graphP3->Fit(fitFunc3_1, "R+");
  graphP3->Fit(fitFunc3_2, "R+");
  graphP3->Fit(fitFunc3_3, "R+");

  fitFunc3_1->SetLineColor(kBlack); 
  fitFunc3_1->Draw("sameL");
  fitFunc3_2->SetLineColor(kBlue); 
  fitFunc3_2->Draw("sameL");
  fitFunc3_3->SetLineColor(kRed); 
  fitFunc3_3->Draw("sameL");
  
  // Para comprobar:
  double x = 3.2502891757210706; 
  double value = fitFunc2_3->Eval(x);  //cuidado con el ndice!!!
  std::cout << "Value of the fit function at x = " << x << " is " << value << std::endl;
  
  TLegend *legend = new TLegend(0.8,0.75,0.86,0.86);  
  legend->SetTextSize(0.03); 
  legend->AddEntry(graphP12,"P = 1.2 bar","p");
  legend->AddEntry(graphP2, "P = 2.0 bar", "p");
  legend->AddEntry(graphP3, "P = 3.0 bar", "p");
  legend->SetFillColor(kWhite); 
  legend->Draw(); 
  
  c1->cd(2)->SetMargin(0.1, 0.1, 0.1, 0.1);
  
  TGraph* graphP12L2 = new TGraph(npoints, energies, eff_P12L2);  
  TGraph* graphP2L2 = new TGraph(npoints, energies, eff_P2L2); 
  TGraph* graphP3L2 = new TGraph(npoints, energies, eff_P3L2);
  
  graphP12L2->SetMarkerStyle(20);
  graphP12L2->SetMarkerSize(1.3);
  graphP12L2->SetMarkerColor(kMagenta+2); 
  graphP12L2->SetLineColor(kMagenta+1); 
  graphP12L2->SetLineWidth(1);
  
  graphP2L2->SetMarkerStyle(20);
  graphP2L2->SetMarkerSize(1.3);
  graphP2L2->SetMarkerColor(kAzure); 
  graphP2L2->SetLineColor(kAzure+7); 
  graphP2L2->SetLineWidth(1);
  
  graphP3L2->SetMarkerStyle(20);
  graphP3L2->SetMarkerSize(1.3);
  graphP3L2->SetMarkerColor(kTeal-1); 
  graphP3L2->SetLineColor(kTeal-5); 
  graphP3L2->SetLineWidth(1);
  
  graphP12L2->SetTitle("");  
  graphP12L2->GetXaxis()->SetTitle("Energy (keV)");         
  graphP12L2->GetXaxis()->SetTitleSize(0.043); 
  graphP12L2->GetXaxis()->SetTitleOffset(1.1);  
  graphP12L2->GetXaxis()->SetLabelSize(0.045); 
  graphP12L2->GetYaxis()->SetTitle("Efficiency (%) for L=2l");  
  graphP12L2->GetYaxis()->SetTitleSize(0.043); 
  graphP12L2->GetYaxis()->SetTitleOffset(0.8); 
  graphP12L2->GetYaxis()->SetLabelSize(0.04); 
  graphP12L2->GetYaxis()->SetRangeUser(0,1);
  
  graphP12L2->Draw("APL");
  graphP2L2->Draw("PLsame");
  graphP3L2->Draw("PLsame");
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_12_1 = new TF1("fitFunc2_12_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_12_2 = new TF1("fitFunc2_12_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_12_3 = new TF1("fitFunc2_12_3", "pol6", 3.25, 16.0);

  // Perform fits
  graphP12L2->Fit(fitFunc2_12_1, "R+");
  graphP12L2->Fit(fitFunc2_12_2, "R+");
  graphP12L2->Fit(fitFunc2_12_3, "R+");

  fitFunc2_12_1->SetLineColor(kBlack); 
  fitFunc2_12_1->Draw("sameL");
  fitFunc2_12_2->SetLineColor(kBlue); 
  fitFunc2_12_2->Draw("sameL");
  fitFunc2_12_3->SetLineColor(kRed); 
  fitFunc2_12_3->Draw("sameL");
  
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_2_1 = new TF1("fitFunc2_2_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_2_2 = new TF1("fitFunc2_2_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_2_3 = new TF1("fitFunc2_2_3", "pol6", 3.25, 16.0);

  // Perform fits
  graphP2L2->Fit(fitFunc2_2_1, "R+");
  graphP2L2->Fit(fitFunc2_2_2, "R+");
  graphP2L2->Fit(fitFunc2_2_3, "R+");

  fitFunc2_2_1->SetLineColor(kBlack); 
  fitFunc2_2_1->Draw("sameL");
  fitFunc2_2_2->SetLineColor(kBlue); 
  fitFunc2_2_2->Draw("sameL");
  fitFunc2_2_3->SetLineColor(kRed); 
  fitFunc2_2_3->Draw("sameL");
  
  
  // Create individual TF1 objects for each fit
  TF1* fitFunc2_3_1 = new TF1("fitFunc2_3_1", "pol6", 0.75, 3.0);
  TF1* fitFunc2_3_2 = new TF1("fitFunc2_3_2", "pol1", 3.0, 3.25);
  TF1* fitFunc2_3_3 = new TF1("fitFunc2_3_3", "pol6", 3.25, 16.01);

  // Perform fits
  graphP3L2->Fit(fitFunc2_3_1, "R+");
  graphP3L2->Fit(fitFunc2_3_2, "R+");
  graphP3L2->Fit(fitFunc2_3_3, "R+");

  fitFunc2_3_1->SetLineColor(kBlack); 
  fitFunc2_3_1->Draw("sameL");
  fitFunc2_3_2->SetLineColor(kBlue); 
  fitFunc2_3_2->Draw("sameL");
  fitFunc2_3_3->SetLineColor(kRed); 
  fitFunc2_3_3->Draw("sameL");
//  
//  // Para comprobar:
//  double x2 = 3.2502891757210706; 
//  double value2 = fitFunc2_2_3->Eval(x);  //cuidado con el ndice!!!
//  std::cout << "Value of the fit function at x = " << x2 << " is " << value2 << std::endl;
  
  
  TLegend *legend2 = new TLegend(0.13,0.75,0.19,0.86);  
  legend2->SetTextSize(0.03); 
  legend2->AddEntry(graphP12L2, "P = 1.2 bar", "p");
  legend2->AddEntry(graphP2L2, "P = 2.0 bar", "p");
  legend2->AddEntry(graphP3L2, "P = 3.0 bar", "p");
  legend2->SetFillColor(kWhite); 
  legend2->Draw(); 

  c1->SaveAs("efficiency_fits.png");  
  c1->SaveAs("efficiency_fits.eps");
  
  TFile * fout = new TFile("Fit_file.root", "recreate"); 
  fitFunc12_1->Write();  
  fitFunc12_2->Write();
  fitFunc12_3->Write();
  fitFunc2_1->Write();  
  fitFunc2_2->Write(); 
  fitFunc2_3->Write();
  fitFunc3_1->Write();  
  fitFunc3_2->Write();
  fitFunc3_3->Write();  //una funcin void hasta aqu, con dos ifs, uno dentro del otro
  
  fitFunc2_12_1->Write();  
  fitFunc2_12_2->Write();
  fitFunc2_12_3->Write();
  fitFunc2_2_1->Write();  
  fitFunc2_2_2->Write();
  fitFunc2_2_3->Write();
  fitFunc2_3_1->Write();  
  fitFunc2_3_2->Write();
  fitFunc2_3_3->Write();  //otra funcin void hasta aqu, como la anterior pero para L=2l
  fout->Close(); 
  
}




void plot_Fe57() {
    double flux = 4.56E23;
    double sigma = 0.00213;
    double mean = 14.4;
    double pi = TMath::Pi();
    double factor = 1.0 / (TMath::Sqrt(2 * pi) * sigma);

    // Create a TGraph object with the function points
    TGraph *graph = new TGraph();

    const int numPoints = 160000;
    double stepSize = 0.0001;
    for (int i = 0; i < numPoints; ++i) {
        double x = i * stepSize;
        double y = flux * factor * exp(- ((x - mean) * (x - mean)) / (2 * sigma * sigma));
        graph->SetPoint(i, x, y);
    }

    // Open the .dat file for writing
    std::ofstream outfile("aN_flux_data.dat");
    if (!outfile.is_open()) {
        std::cerr << "Error opening file." << std::endl;
        return;
    }

    // Write the x and y coordinates to the file
    for (int i = 0; i < numPoints; ++i) {
        double x, y;
        graph->GetPoint(i, x, y);
        outfile << x << " " << y << std::endl;
    }

    // Close the file
    outfile.close();

    TCanvas *c1 = new TCanvas("c1", "Graph of aN_dif_flux", 2000, 900); // Reduced canvas size

    graph->SetTitle(""); 
    graph->Draw("AL"); // Default color is used here
    graph->SetLineColor(kBlue); // Set the line color to blue
    graph->SetMarkerColor(kBlue);
    graph->SetLineWidth(2);
    graph->GetXaxis()->SetRangeUser(14.3, 14.5);
    graph->GetXaxis()->SetTitle("E_{a} [keV]");
    graph->GetYaxis()->SetTitle("#frac{d#phi_{a}}{dE_{a}} @g_{aN}^{eff} [s^{-1}cm^{-2}]");
    c1->SaveAs("aN_diferential_flux.png");
}


